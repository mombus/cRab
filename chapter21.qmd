---
title: "Оценка естественной смертности"
format: html
---

## Введение

Это практическое занятие посвящено оценке естественной смертности (M) и отношения естественной смертности к коэффициенту роста M/k  (или M/K) для последующего применения length-based методов в условиях ограниченных данных (LBSPR, LBB, LIME). Из одних только распределений по длине M и K по отдельности определяются слабо: разные комбинации “быстроты роста” и “интенсивности фоновой смертности” могут производить схожие размерно-частотные профили. Поэтому мы целенаправленно:

1\) получаем независимые оценки M из разных источников (эмпирики и «встроенные» в наши данные методы); 2) объединяем их в единый согласованный приор на M; 3) переводим его в приор на M/k, используя K из уравнения роста (например, из [ELEFAN](https://mombus.github.io/cRab/chapter20.html)).

Почему так: LBSPR и LBB работают именно с M/k, а в LIME M обычно фиксируют или задают информативный прайер (приор). Для краба-стригуна опилио (Баренцево море) возрастные признаки недоступны, а съёмочные индексы имеют вариативный коэффициент уловистости (q). Комбинация нескольких независимых методов позволяет снизить смещение каждого по отдельности и явным образом учесть неопределённость.

## Определения и биологический смысл

\- Естественная смертность M (год−1): мгновенная скорость выбывания из популяции по всем причинам, не связанным с промыслом (хищники, болезни, старение, экстремальные условия). Годовая выживаемость S ≈ e\^(−M). Общая смертность: Z = M + F, где F – промысловая смертность, Z – общая.

\- Коэффициент роста уравнения Берталанфи (ВБГФ) *K* (год−1; часто пишут *k*): задаёт временной масштаб приближения к *L∞*. Чем больше *K*, тем быстрее достигается близость к асимптоте. Ориентир: t95 ≈ 3/K — время до 95% L∞ (для несезонной формы).

\- Отношение M/k (безразмерно): сравнительная «быстрота» фоновой смертности относительно темпа роста. Большое M/k — “быстрый” жизненный цикл (высокие потери относительно роста), малое — “медленный” (рост доминирует над смертностью). Это ключевой инвариант в length-based моделях.

## Какие методы мы используем и почему

1\) Эмпирика Pauly\* (M как функция L∞, K и температуры T)

\- Биологический смысл. Основана на метаболической и жизненно-исторической масштабируемости: у видов/популяций с меньшим L∞ и большим K (быстрый рост) фоновые потери обычно выше; в тёплой воде метаболизм быстрее и M выше. Формула агрегирует большую базу запасов, давая устойчивый ориентир.

\- Зачем в нашем случае. Это «внешняя» информация о M, не зависящая от специфики наших выборок и q. Для холодноводных бенто-пелагических сообществ Баренцева моря используем реалистичную сетку придонных температур (например, 1–3 °C), чтобы получить диапазон M, а не единую точку.

\- Пример (на наших оценках роста): L∞ ≈ 163 мм (16.3 см), K ≈ 0.211 год−1. При T = 1; 2; 3 °C формула Паули даёт M приблизительно 0.16; 0.23; 0.27 год−1. Это разумный “якорь” для холодных вод.

\- Сильные стороны. Просто, прозрачно, независимая опора на жизненно-исторические закономерности.

\- Ограничения. Формула выведена на рыбах и на длине тела (см), а у нас ширина карапакса (мм): возможна структурная погрешность шкалы. Используем как ориентир, а не истину в последней инстанции.

\*Pauly, D. (1987). A review of the ELEFAN system for analysis of length-frequency data in fish and aquatic invertebrates. In: D. Pauly & G. R. Morgan (Eds.), Length-based methods in fisheries research (pp. 7–34). ICLARM Conference Proceedings 13. International Center for Living Aquatic Resources Management (ICLARM), Manila.

2\) Эмпирика Then\*\* по максимальному возрасту tmax

\- Биологический смысл. По сути — обратное от Pauly: вместо температуры и роста используем “сколько живут”. Чем меньше tmax, тем выше M, и наоборот. Это один из самых информативных эмпирических предикторов.

\- Проблема для крабов. Истинный tmax редко известен. Выходим так: аппроксимируем tmax из наблюдаемых максимальных размеров (Lmax или высоких квантилей, например Q97.5–Q99) через обратный ВБГФ: t(L) = t0 − (1/K) ln(1 − L/L∞). Это даёт оценку возраста у самых крупных особей. Она, скорее всего, занижает истинный максимум (из-за выборки, терминальной линьки, границ по селективности) — значит, получаем верхнюю границу M (консервативно вверх).

\- Пример. Для Q99 ≈ 150 мм при L∞ ≈ 163 мм, K ≈ 0.211, t0 ≈ 0.8 получаем tmax ≈ 12.5–13 лет. Тогда по Then (M = 4.899·tmax\^−0.916), т.е.  M ≈ 0.4–0.5 год−1. Это выше, чем по Паули, и логично как верхняя граница (мы взяли “слишком короткую” жизнь, а значит M «перестрахованно» высока).

\- Сильные стороны. Задействует независимую информацию о “долголетии”.

\- Ограничения. Очень чувствителен к tmax; оценка tmax из Lq может быть смещена вниз; даёт верхнюю границу M. Корректнее использовать Q97.5–Q99 и/или прибавлять 1–3 года к tmax по экспертной информации.

\*\*Then, A. Y., Hoenig, J. M., Hall, N. G., & Hewitt, D. A. (2015). Evaluating the predictive performance of empirical estimators of natural mortality rate using information on life history and their application to fish stocks. ICES Journal of Marine Science, 72(1), 82–92. https://doi.org/10.1093/icesjms/fsu136

3\) Lorenzen \*\*\* (M как функция массы: M = c·W\^−d)

\- Биологический смысл. Множество видов показывает метрическое снижение смертности с ростом массы: мелкие особи уязвимее к хищникам и стрессам; крупные — устойчивее. Это «механистический» взгляд на смертность, заданный через массу (W = a·L\^b).

\- Как применяем к опилио. Сначала подгоняем длина–масса W = a·CW\^b по вашим данным (отдельно по полу или суммарно). Затем получаем M(L) = c·\[a·L\^b\]\^−d и усредняем по диапазону «полной улавливаемости» промысла (например, L ≥ 110 мм) — это даёт “эффективное” M для взрослых, релевантное length-based моделям.

\- Пример. По вашим коэффициентам для самцов (a ≈ 4.54e−4; b ≈ 2.96) крабы 120–160 мм весят примерно 0.6–1.5 кг. При “рыбьих” константах c ≈ 3, d ≈ 0.288 типично получается M \~ 0.25–0.45 год−1 по взрослым размерам. Но это важно: c и d получены для рыб; для ракообразных лучше калибровать хотя бы c так, чтобы “среднее” M по Lorenzen не конфликтовало с Паули/Then и с независимыми оценками. В наших целях Lorenzen — источник формы M(L) и ориентиров по взрослой части размерного спектра.

\- Сильные стороны. Даёт длино-специфичную смертность и биологически реалистичную зависимость “крупнее — живут дольше”.

\- Ограничения. Требует корректных a,b (длина–масса) и видоспецифичных c,d; чувствителен к единицам массы.

\*\*\* Lorenzen, K. (2000). Allometry of natural mortality as a basis for assessing optimal release size in fish-stocking programmes. Canadian Journal of Fisheries and Aquatic Sciences, 57(12), 2374–2381. https://doi.org/10.1139/f00-215

4\) Length-converted catch curve: Z из нисходящей ветви + M = Z − F (через C/B при неопределённом q)

\- Биологический смысл. На стационарном массиве с постоянной селективностью и пополнении нисходящая ветвь размерной частоты (правее моды) убывает экспоненциально: наклон в шкале ln N — это −Z. Мы «переводим» длину в возраст через ВБГФ и регрессируем ln(n/Δt) по t в правой части. Получаем Z = M + F.

\- Как отделяем M от F. Используем ежегодные выловы C и индекс съёмки I = q·B. Если q был бы известен, F ≈ −ln(1 − C/B). Но q переменный, поэтому задаём логнормальный приор q \~ Lognormal(median, CV), делаем Монте‑Карло: B = I/q, F = −ln(1 − C/B), M = Z − F. На выходе — распределение M, отражающее неопределённость в q.

\- Пример. Если по съёмке получаем Z ≈ 0.55 год−1, а при q\~Lognormal(медиана 0.3, CV 0.5) типичные F оказываются 0.20–0.35 год−1, то M = Z − F “ложится” в 0.20–0.35 год−1, что хорошо согласуется с диапазоном Паули и ниже “верхней границы” Then.

\- Сильные стороны. Прямо использует ваши эмпирические ряды по длине, выловы и индексы — то есть укоренена в данных конкретной популяции.

\- Ограничения. Требует стационарности и стабильной селективности на правой ветви; чувствительна к выбору диапазона длин; зависит от предположений о q (мы честно вносим их в неопределённость).

## Как мы объединяем источники и выходим на M/k

\- Мы собираем все M-оценки: Pauly (сетка T), Then (через tmax из Lq), Lorenzen (при наличии корректных a,b; усреднённое M по взрослым длинам), Z−F (MC по q).

\- Режем экстремальные хвосты (например, 99-й перцентиль) и аппроксимируем приор на M логнормальным распределением (лог‑среднее и лог‑SD).

\- Получаем сводную оценку M (медиана и 95% интервал) и переводим её в M/k, деля на K из роста (ELEFAN). Именно M/k нужен напрямую LBSPR/LBB, а в LIME его удобно использовать как проверку/настройку фиксированного M.

## Зачем нам сразу несколько методов

\- Они опираются на разные «оси» биологии: температура и темп жизни (Pauly), долгожительство (Then), размер и плотность энергии (Lorenzen), фактический профиль размерной убыли и эксплуатация (catch curve + C/B).

\- Смещения у них разнонаправленные: Then с Lq даёт верхние границы M; Pauly в холодных водах — умеренные; Lorenzen — структуру по размеру; Z−F — якорение в ваших данных, но с неопределённым q. Комбинация стабилизирует итог и делает приор на M (а затем и M/k) “честно широким”, но информативным.

## Практические ориентиры и проверка здравого смысла

\- Согласованность с ростом: t95 ≈ 3/K. Если K ≈ 0.21, то t95 ≈ 14 лет — M «очевидно» не может быть чрезмерно высоким, иначе структура длин бы «ломалась».

\- Согласованность источников: разумно ожидать, что медиана M попадёт в «общий» коридор Pauly и Z−F, а Then задаст верхнюю границу.

\- Согласованность с литературой по опилио: взрослые самцы в холодных морях — M обычно низко‑средний (около 0.15–0.35 год−1), с вариациями по районам и периодам.

## Итог

\- Pauly даёт внешний температурно‑жизненно‑исторический “якорь” M.

\- Then даёт «потолок» M через tmax, особенно полезен как проверка — не завышаем ли долгожительство.

\- Lorenzen добавляет длино‑специфичность и биологическую правдоподобность “крупнее — живут дольше” (важно для взрослых самцов опилио).

\- Length‑converted catch curve и C/B с неопределённым q якорят оценку M в ваших данных (съёмка+промысел) и честно вносят q в интервал неопределённости.

\- Комбинируя их, мы получаем прозрачный и согласованный приор на M и производный приор на M/k — именно то, что нужно для дальнейших length‑based оценок (LBSPR, LBB, LIME) в условиях ограниченных данных и меняющегося q в Баренцевом море.

## Скрипт и входные данные

[Скрипт](https://mombus.github.io/cRab/data/M_all_methods.R).

ВХОДНЫЕ ДАННЫЕ (должны быть в рабочей директории):

-   [SURVEYDATA.csv](https://mombus.github.io/cRab/data/SURVEYDATA.csv) - данные съемки (длины особей)
-   [FISHERYDATA.csv](https://mombus.github.io/cRab/data/FISHERYDATA.csv) - данные промысла (длины особей)
-   [CATCH.csv](https://mombus.github.io/cRab/data/CATCH.csv) - годовые уловы (тонны)
-   [SURVEY_INDEX.csv](https://mombus.github.io/cRab/data/SURVEY_INDEX.csv) - индексы биомассы по годам
-   [ELEFAN_params_constrained.csv](https://mombus.github.io/cRab/data/ELEFAN_params_constrained.csv) - параметры роста (Linf, K, t_anchor)
-   [LW_coeffs.csv](https://mombus.github.io/cRab/data/LW_coeffs.csv) - коэффициенты длина-масса

---
title: "Байесовский подход"
format: html
---

### Введение

Если частотная статистика — это формальная наука о том, *что говорят данные*, то байесовский подход — это искусство ведения диалога между данными и нашими предварительными "априорными" знаниями. Байесовская философия радикально проста: мы начинаем не с чистого листа, а с формализованного опыта — *априорного распределения*. Затем данные вносят свои коррективы, и мы получаем *апостериорное распределение* — обновлённые знания, которые уже учитывают и экспертизу, и наблюдения. Фундаментальное соотношение байесовского вывода задаётся формулой Байеса:

$$
P(\theta \mid D) = \frac{P(D \mid \theta) \cdot P(\theta)}{P(D)}
$$

где:

-   $P(\theta)$ — **априорная вероятность**, отражающая наши знания или убеждения о параметре $\theta$ *до* наблюдения данных;
-   $P(D \mid \theta)$ — **правдоподобие**, то есть вероятность наблюдать данные $D$ при заданном значении параметра $\theta$;
-   $P(\theta \mid D)$ — **апостериорная вероятность**, представляющая обновлённые знания о $\theta$ *после* учёта данных $D$;
-   $P(D)$ — нормировочная константа (маргинальное правдоподобие), обеспечивающая, чтобы апостериорное распределение интегрировалось к единице.

На практике часто используют пропорциональную форму, так как $P(D)$ не зависит от $\theta$:

$$
P(\theta \mid D) \propto P(D \mid \theta) \cdot P(\theta)
$$ В контексте оценки, например, роста рыб это означает: мы можем использовать знания о похожих видах, предыдущие исследования или даже экспертные оценки ("байки бывалых ихтиологов") , чтобы задать более или менее реалистичные ожидания для параметров уравнения Берталанфи — до того, как увидим первую точку данных.

В практике оценки водных биоресурсов мы редко сталкиваемся с полными, сбалансированными и «чистыми» данными. Чаще всего перед нами — разрозненные уловы, фрагментарные съёмки, практически полное отсутствие возрастной структуры, неточная методика сбора и, как следствие, высокая неопределённость. В таких условиях классические частотные методы — опирающиеся на идею «единственной истинной оценки» — часто дают иллюзию точности, скрывая за красивыми p‑значениями хрупкость выводов.

Байесовский подход предлагает иной путь — **не бороться с неопределённостью, а моделировать её явно**. Его суть лежит не столько в формулах, сколько в мировоззрении:

> «Все знания условны. Мы начинаем с того, что знаем (априорное знание), обновляем это знание по мере поступления данных (правдоподобие) и получаем то, что знаем теперь (апостериорное знание)».

Это особенно важно в гидробиологии, где экспертные суждения ихтиологов, данные по близкородственным видам, исторические аналоги и даже здравый смысл часто содержат больше информации, чем несколько десятков наблюдений. Байесовский формализм позволяет **превратить субъективное мнение в количественную гипотезу**, которую можно проверить, скорректировать и объединить с эмпирическими данными.

### **Почему именно байесовский подход в оценке роста?**

Уравнение фон Берталанффи — классический инструмент описания роста рыб, но его параметры (*L∞* и *K*) чрезвычайно чувствительны к структуре данных. При малом числе возрастных групп или смещённой выборке (например, только молодые особи) классическая нелинейная регрессия может выдать биологически неправдоподобные оценки: *L∞* = 200 см у трески или *K* = 0.01 у короткоживущей сельди. Байесовский подход решает эту проблему через **ограничение пространства поиска** с помощью априорных распределений, основанных на биологических знаниях.

Например, если эксперт говорит: «У этого вида предельная длина, скорее всего, около 55 см, но может колебаться от 40 до 70 см», мы не игнорируем это как «ненаучное», а записываем в виде нормального распределения *L∞ \~ N(55, 10)*. Это не догма — это **рабочая гипотеза**, которую данные могут усилить, ослабить или полностью опровергнуть.

РИСУНОК 1

### **Что даёт байесовский подход на практике?**

1.  **Количественная оценка неопределённости.**\
    Вместо одного числа (например, *L∞ = 62.2 см*) мы получаем **полное распределение вероятностей**, из которого можно извлечь доверительные интервалы, стандартные ошибки и даже вероятность того, что *L∞ \> 70 см*. Это важно при управлении запасами: если 95% интервал для *L∞* включает значения, при которых MSY падает на 30%, это сигнал к осторожности (в моделях оценки *L~opt~*).

2.  **Устойчивость при малых выборках.**\
    Даже при 4–6 наблюдениях байесовская модель не «ломается», а выдаёт обоснованную оценку, основанную на компромиссе между данными и априором. Это делает её идеальной для редких, труднодоступных или недавно осваиваемых видов.

3.  **Прозрачность допущений.**\
    Все исходные предположения — о диапазоне *K*, форме распределения ошибок, степени корреляции параметров — задаются явно. Это позволяет легко проводить **анализ чувствительности**: что изменится, если эксперт ошибся на 10%? Как повлияет изменение формы прайера (априора)?

4.  **Интеграция разных источников информации.**\
    Байесовский каркас естественно объединяет данные съёмок, промысла, лабораторных экспериментов и литературных обзоров в единую модель. Это особенно ценно в условиях Data-Limited Fisheries, где каждый фрагмент информации на вес золота.

### **Байес как мост между наукой и управлением**

Управленческие решения в рыболовстве редко принимаются в условиях полной определённости. Регуляторы хотят знать не только «какой ОДУ (общий допустимый улов) установить», но и **«с какой вероятностью мы не переловим при таком ОДУ»**. Байесовский подход отвечает на этот вопрос напрямую: он даёт распределение возможных траекторий запаса, а не одну «среднюю» линию. Это позволяет строить **предосторожные стратегии**, учитывающие худший, средний и лучший сценарии.

Кроме того, байесовские результаты легко интерпретировать даже для нестатистиков:

> «С вероятностью 90% предельная длина находится между 58 и 66 см» — это понятнее, чем «коэффициент значим при p \< 0.05».

### **Дисциплина скромности**

Байесовский подход — это не просто набор формул, а **интеллектуальная дисциплина**. Он заставляет нас признать:

-   Мы не знаем всего.

-   Наши данные неполны.

-   Наши модели — упрощения реальности.

Но вместо того чтобы скрывать эти ограничения, байесовский анализ делает их частью процесса. Он учит нас **думать вероятностно**, принимать решения, устойчивые к неопределённости, и честно сообщать о границах нашего знания.

В этом практическом занятии мы не просто «прогоним скрипт», а пройдём полный цикл байесовского анализа: от формализации экспертного мнения до визуализации апостериорных распределений и интерпретации результатов в контексте устойчивого управления. Мы увидим, как даже скудные данные, в сочетании с биологическим смыслом, позволяют построить надёжную оценку параметров роста — и, что важнее, **понять, насколько этой оценке можно доверять**.

### **Что делаем?**

Практическое занятие посвящено байесовскому подходу в оценке параметров роста рыбы на примере уравнения фон Берталанффи в условиях ограниченных данных. Основная цель — наглядно продемонстрировать, как априорные знания эксперта, объединенные с небольшим набором наблюдений, формируют уточненное апостериорное знание о биологических параметрах. Биологическая задача заключается в оценке параметров *L∞* или *L~inf~* (предельная длина) и *K* (константа роста) для гипотетического вида рыбы при очень скудной выборке измерений длины и возраста. Уравнение роста используется в упрощенной форме без учета *t~0~*: *L~age~* = *L~inf~* × (1 - exp(-*K* × age)).

Ключевая идея байесовского подхода выражается формулой: апостериорное распределение пропорционально правдоподобию данных, умноженному на априорное распределение. Это означает, что мы начинаем не с чистого листа, а с формализованного опыта, который затем корректируется наблюдаемыми данными. Для реализации подхода в R используются пакеты `ggplot2` для визуализации, `dplyr` для манипуляций с данными и `MASS` для вспомогательных статистических функций.

На первом этапе создается искусственная "истинная" популяция с параметрами *L~inf~* = 60 см и *K* = 0.27/год, чтобы иметь эталон для сравнения или чтобы понимать, к чему мы стремимся в оценке. Генерируется полная кривая роста для возрастов от 1 до 15 лет, которая визуализируется как эталонный образец. Затем моделируется реальная ситуация недостатка данных — шесть промеров "реальной" рыбы. Выбираются всего шесть возрастов (1, 2, 4, 6, 10 и 14 лет), для которых генерируются "наблюдаемые" данные с добавлением случайной ошибки измерения (стандартное отклонение 2 см). Визуализация показывает, насколько ограниченные данные не позволяют точно восстановить истинную кривую роста классическими методами.

Экспертные знания формализуются в виде априорных распределений: для *L~inf~* задается нормальное распределение с средним 55 см и стандартным отклонением 10 см, для *K* — нормальное распределение с средним 0.25/год и стандартным отклонением 0.08/год. Эти прайеры (априоры или priors) отражают знания гидробиолога о похожих видах в данном водоеме или более ранние сообщения о поимках крупных особей этого же вида "бывалыми" ихтиологами. Создается сетка возможных значений параметров (150 × 150 точек), на которой вычисляются плотности априорных распределений. Визуализация включает маргинальные распределения для каждого параметра и совместное распределение, где отмечаются истинные значения параметров и мнение эксперта.

Функция правдоподобия вычисляется на основе нормального распределения ошибок наблюдений с стандартным отклонением 2.5. Для каждой комбинации параметров сетки рассчитывается логарифм правдоподобия, который затем преобразуется в шкалу вероятностей. Визуализация правдоподобия показывает, какие комбинации параметров лучше всего объясняют наблюдаемые данные. Важно отметить, что из-за малого количества данных функция правдоподобия довольно широкая, что отражает высокую неопределенность оценок.

Апостериорное распределение вычисляется как произведение априорного распределения и правдоподобия с последующей нормализацией. Визуализация апостериорного распределения демонстрирует, как сочетание априорных знаний и данных сужает область вероятных значений параметров. Маргинализация позволяет получить распределения для каждого параметра в отдельности, на которых хорошо видно смещение оценок в сторону как априорных ожиданий, так и наблюдаемых данных.

Рассчитываются точечные оценки параметров как средние апостериорные значения: *L~inf~* = 62.2 см (истинное значение 60 см), *K* = 0.263/год (истинное значение 0.27/год). Стандартные отклонения апостериорных распределений составляют 2.3 см для *L~inf~* и 0.026/год для *K*. Методом сэмплирования строятся 95% доверительные интервалы: для *L~inf~* от 57.9 до 67.0 см, для *K* от 0.215 до 0.317/год. Эти интервалы количественно характеризуют неопределенность оценок.

Финальная визуализация показывает 150 случайных кривых роста, сгенерированных из апостериорного распределения. Тонкие красные линии иллюстрируют неопределенность оценки, темно-красная линия показывает среднюю апостериорную кривую, синяя линия — истинную кривую, а зеленые точки — наблюдаемые данные. Такой подход наглядно демонстрирует байесовскую философию: мы получаем не единственную "лучшую" кривую, а целое семейство возможных кривых с соответствующими вероятностями, что позволяет адекватно оценивать неопределенность прогнозов.

Заключение подчеркивает преимущества байесовского подхода: эффективное сочетание экспертных знаний с ограниченными данными, количественную оценку неопределенности и интерпретируемость результатов в терминах вероятностей. В условиях малых выборок, типичных для гидробиологических исследований, такой подход позволяет получать более реалистичные и надежные оценки параметров роста рыб.

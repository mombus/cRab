[
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "Оценка водных биоресурсов при недостатке данных в среде R (для начинающих)",
    "section": "",
    "text": "Аннотация\nБаканев С. В. (2025) Оценка водных биоресурсов при недостатке данных в среде R (для начинающих). — Курс лекций и практических занятий, адрес доступа: https://mombus.github.io/cRab\nЗдесь будет краткая аннотация.",
    "crumbs": [
      "Аннотация"
    ]
  },
  {
    "objectID": "intro.html",
    "href": "intro.html",
    "title": "1  Введение",
    "section": "",
    "text": "В эпоху больших языковых моделей (LLM) вопрос об актуальности создания структурированных учебников кажется закономерным. Зачем тратить время на детальную проработку курса, если современные инструменты способны быстро сгенерировать объяснение даже сложных тем — от статистических формул до методов оценки запасов? Однако многолетний опыт работы с количественными данными в морской биологии подсказывает: формальные алгоритмы не заменят практического понимания, необходимого для адаптации теоретических подходов к реальным условиям.\nLLM могут описать формулу Бейеса или работу программного обеспечения для оценки запасов, но они не научат учитывать специфику конкретного региона — например, как интерпретировать противоречивые данные с научных съемок или корректировать модели в условиях изменяющегося климата. Именно в таких ситуациях ключевую роль играет опыт: годы наблюдений, анализ ошибок и постепенная выработка гибких подходов к решению задач.\nЭтот репозиторий — собрание проверенных методов, применявшихся при решении прикладных задач: от обработки данных CPUE при неполном покрытии акватории до моделирования распространения инвазивных видов с учетом геоморфологических особенностей. Здесь вы найдете примеры, редко встречающиеся в общедоступных источниках: как работать с фрагментированными биотопами или оценивать сдвиги в ареалах видов на основе долгосрочных наблюдений.\nБольшие языковые модели — полезный инструмент, но их ответы часто абстрактны. Реальная работа с данными требует не только технических навыков, но и умения адаптироваться к уникальным условиям, где неопределенность — норма, а решения рождаются через анализ конкретных случаев. Этот учебник направлен на передачу именно такого «живого» опыта, который невозможно заменить автоматически сгенерированными текстами.",
    "crumbs": [
      "<span class='chapter-number'>1</span>  <span class='chapter-title'>Введение</span>"
    ]
  },
  {
    "objectID": "summary.html",
    "href": "summary.html",
    "title": "2  Summary",
    "section": "",
    "text": "In summary, this book has no content whatsoever.\n\n1 + 1\n\n[1] 2",
    "crumbs": [
      "<span class='chapter-number'>2</span>  <span class='chapter-title'>Summary</span>"
    ]
  },
  {
    "objectID": "references.html",
    "href": "references.html",
    "title": "References",
    "section": "",
    "text": "Knuth, Donald E. 1984. “Literate Programming.” Comput.\nJ. 27 (2): 97–111. https://doi.org/10.1093/comjnl/27.2.97.",
    "crumbs": [
      "References"
    ]
  },
  {
    "objectID": "chapter 1.html",
    "href": "chapter 1.html",
    "title": "2  Анализ и визуализация данных улова",
    "section": "",
    "text": "2.1 Введение (в R)",
    "crumbs": [
      "<span class='chapter-number'>2</span>  <span class='chapter-title'>Анализ и визуализация данных улова</span>"
    ]
  },
  {
    "objectID": "chapter 1.html#загрузка-данных-и-первичный-осмотр",
    "href": "chapter 1.html#загрузка-данных-и-первичный-осмотр",
    "title": "2  Анализ и визуализация данных улова",
    "section": "2.2 Загрузка данных и первичный осмотр",
    "text": "2.2 Загрузка данных и первичный осмотр\nссылка на файл: shrimp_catch.csv\n\n# Установка рабочей директории\nsetwd(\"C:/TEXTBOOK/\")\n# Загрузка библиотек\nlibrary(tidyverse)\n# Загрузка данных\ndata &lt;- read_csv(\"shrimp_catch.csv\")\n\nКоманда glimpse знакомит со структурой данных:\n\n# Просмотр структуры и первых строк загруженных данных\nglimpse(data)\n\n\nRows: 230\nColumns: 5\n$ id     &lt;int&gt; 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, ~\n$ age    &lt;int&gt; 2, 4, 4, 4, 1, 4, 2, 2, 4, 3, 4, 3, 2, 1, 2, 1, 2, 2, 2, 2, 3, ~\n$ length &lt;dbl&gt; 20.45450, 25.88928, 29.42257, 30.68292, 12.46059, 28.52152, 17.~\n$ weight &lt;dbl&gt; 1.28221748, 1.97476899, 2.65412595, 3.44746476, 0.13404801, 2.3~\n$ sex    &lt;chr&gt; \"M\", \"F\", \"F\", \"F\", \"M\", \"F\", \"M\", \"M\", \"F\", \"F\", \"F\", \"F\", \"M\"~\n&gt; \n\nМожно использовать команду str — показывает внутреннюю структуру объекта , включая количество строк, столбцов, названия переменных, их типы (chr, num, int и др.), а также несколько первых значений.\n\nstr(data)\n\n\n'data.frame':   230 obs. of  5 variables:\n $ id    : int  1 2 3 4 5 6 7 8 9 10 ...\n $ age   : int  2 4 4 4 1 4 2 2 4 3 ...\n $ length: num  20.5 25.9 29.4 30.7 12.5 ...\n $ weight: num  1.282 1.975 2.654 3.447 0.134 ...\n $ sex   : chr  \"M\" \"F\" \"F\" \"F\" ...\n&gt;",
    "crumbs": [
      "<span class='chapter-number'>2</span>  <span class='chapter-title'>Анализ и визуализация данных улова</span>"
    ]
  },
  {
    "objectID": "chapter 1.html#описательная-статистика-и-визуализация",
    "href": "chapter 1.html#описательная-статистика-и-визуализация",
    "title": "2  Анализ и визуализация данных улова",
    "section": "2.3 Описательная статистика и визуализация",
    "text": "2.3 Описательная статистика и визуализация\nКоманда summary выводит описательную статистику для каждой числовой переменной: минимум, 1-й квартиль, медиана, среднее, 3-й квартиль, максимум; для категориальных переменных — частоты.\n\n# Общая статистика\nsummary(data)\n\n\n       id              age            length          weight       \n Min.   :  1.00   Min.   :1.000   Min.   : 7.65   Min.   :-0.3334  \n 1st Qu.: 58.25   1st Qu.:2.000   1st Qu.:17.62   1st Qu.: 0.6320  \n Median :115.50   Median :3.000   Median :22.49   Median : 1.3660  \n Mean   :115.50   Mean   :2.509   Mean   :21.68   Mean   : 1.4933  \n 3rd Qu.:172.75   3rd Qu.:3.000   3rd Qu.:26.03   3rd Qu.: 2.1148  \n Max.   :230.00   Max.   :4.000   Max.   :36.02   Max.   : 5.1316  \n     sex           \n Length:230        \n Class :character  \n Mode  :character  \n\nПростейшими командами можно вычислить, например, соотоношение полов или корреляцию длина-вес.\n\n# Соотношение полов\nprop.table(table(data$sex)) %&gt;% round(2)\n\n\n   F    M \n0.35 0.65 \n\n\n# Корреляция длина-вес с p-value\ncor_test &lt;- cor.test(data$length, data$weight, \n                     method = \"pearson\", \n                     exact = FALSE,\n                     na.action = na.omit)\n \ncor_coef &lt;- round(cor_test$estimate, 2)\np_value &lt;- scales::pvalue(cor_test$p.value, accuracy = .001)\n \ncat(\"Корреляция Пирсона: r =\", cor_coef, \", p =\", p_value, \"\\n\")\n\n\nКорреляция Пирсона: r = 0.95 , p = &lt;0.001 \n\n\n# Распределение возраста\ntable(data$age)\n\n\n1  2  3  4 \n43 68 77 40 \n\n\n# Средние значения длины и веса по группам\ndata %&gt;%\n   group_by(age) %&gt;%\n   summarise(\n     mean_length = mean(length),\n     sd_length = sd(length),\n     mean_weight = mean(weight),\n     sd_weight = sd(weight))\n\n\n# A tibble: 4 x 5\n    age mean_length sd_length mean_weight sd_weight\n  &lt;dbl&gt;       &lt;dbl&gt;     &lt;dbl&gt;       &lt;dbl&gt;     &lt;dbl&gt;\n1     1        12.7      1.37       0.249     0.234\n2     2        19.2      1.88       0.919     0.341\n3     3        24.8      1.72       1.88      0.424\n4     4        29.1      2.28       2.96      0.804\n&gt; \n\n\n2.3.1 Построение гистограммы для переменной ‘length’ (длина креветок)\nДля первого визуального знакомства команда hist строит гистограмму — простой график, который показывает, как распределены значения числовой переменной. В данном случае отображается распределение длин креветок из набора данных.\n\nhist(data$length, \n     main = \"Гистограмма длины креветок\",          # Заголовок графика\n     xlab = \"Длина (см)\",                          # Подпись оси X\n     ylab = \"Частота\",                             # Подпись оси Y\n     col = \"lightblue\",                            # Цвет столбцов\n     border = \"black\",                             # Цвет границ столбцов\n     breaks = 15)                                   # Количество интервалов\n\n\n\n\nРис. 1.1: Гистограмма длины креветок\n\n\n\n\n2.3.2 Визуализация в ggridges\nДля элегантных и компактных графиков подходит библиотека ggridges. Посторим распределение длины креветки в зависимости от пола и возраста.\n\nlibrary(ggplot2)\nlibrary(ggridges)\n\nggplot(data, aes(x = length, \n                 y = sex, \n                 group = sex, \n                 fill = sex)) +\n  geom_density_ridges(scale = 2, alpha = 0.7) +\n  scale_y_discrete(expand = c(0, 0)) +\n  scale_x_continuous(expand = c(0, 0)) +\n  labs(\n    title = \"Распределение длины карапакса по полу\",\n    x = \"Длина карапакса (мм)\",\n    y = \"Пол\"\n  ) +\n  theme(\n    panel.border = element_blank(),  # Убирает рамку вокруг графика\n    axis.line = element_line(color = \"black\")  # Сохраняет осевые линии (опционально)\n  )\n\n\n\n\nРис. 1.2: Пол-длина креветок с использованием ggridges",
    "crumbs": [
      "<span class='chapter-number'>2</span>  <span class='chapter-title'>Анализ и визуализация данных улова</span>"
    ]
  },
  {
    "objectID": "chapter 1.html#выявление-аутлайеров",
    "href": "chapter 1.html#выявление-аутлайеров",
    "title": "2  Анализ и визуализация данных улова",
    "section": "2.4 Выявление аутлайеров",
    "text": "2.4 Выявление аутлайеров\nТекст. Текст. Текст.",
    "crumbs": [
      "<span class='chapter-number'>2</span>  <span class='chapter-title'>Анализ и визуализация данных улова</span>"
    ]
  },
  {
    "objectID": "chapter 3.html",
    "href": "chapter 3.html",
    "title": "4  От регрессии и до нейронных сетей",
    "section": "",
    "text": "4.1 Введение",
    "crumbs": [
      "<span class='chapter-number'>4</span>  <span class='chapter-title'>От регрессии и до нейронных сетей</span>"
    ]
  },
  {
    "objectID": "chapter 3.html#раздел",
    "href": "chapter 3.html#раздел",
    "title": "4  Введение в картографию",
    "section": "4.2 Раздел",
    "text": "4.2 Раздел\nТекст. Текст. Текст.",
    "crumbs": [
      "<span class='chapter-number'>4</span>  <span class='chapter-title'>Введение в картографию</span>"
    ]
  },
  {
    "objectID": "chapter 3.html#раздел-1",
    "href": "chapter 3.html#раздел-1",
    "title": "4  Введение в картографию",
    "section": "4.3 Раздел",
    "text": "4.3 Раздел\nТекст. Текст. Текст.",
    "crumbs": [
      "<span class='chapter-number'>4</span>  <span class='chapter-title'>Введение в картографию</span>"
    ]
  },
  {
    "objectID": "chapter 3.html#выявление-аутлайеров",
    "href": "chapter 3.html#выявление-аутлайеров",
    "title": "4  Введение в картографию",
    "section": "4.4 Выявление аутлайеров",
    "text": "4.4 Выявление аутлайеров\nТекст. Текст. Текст.",
    "crumbs": [
      "<span class='chapter-number'>4</span>  <span class='chapter-title'>Введение в картографию</span>"
    ]
  },
  {
    "objectID": "chapter 2.html",
    "href": "chapter 2.html",
    "title": "3  Нейронные сети в экологии: практическое введение",
    "section": "",
    "text": "3.1 Введение\nЭто практическое занятие можно рассматривать не только как введение в нейронные сети, но и как введение в экологическое моделирование в общем с помошью R. Занятие основано на статье Андрея Викторовича Коросова “Нейронные сети в экологии: введение”, опубликованной в журнале Принципы экологии, №3, 2023, стр. 76-96. В статье рассмотрены основы нейросетевого моделирования в экологии, начиная с классических регрессионных методов и заканчивая искусственными нейронными сетями. Представленные примеры демонстрируют эволюционный переход от простых линейных моделей к сложным нейросетевым конструкциям, что позволяет решать задачи классификации и прогнозирования в экологии. “Теоретическая” лекция, основанная на этой статье, находиться по ссылке.\nМожно скачать скрипт целиком в трех версиях: KOROSOV.R - максимально приближен к оригинальной работе; KOROSOV_updated.R - тотже скрипт, но с комментариями и пояснениями (содержание этого занятия); KOROSOV_visual.R - почти такой же с дополнительным продвинутым визуалом и аналитикой.",
    "crumbs": [
      "<span class='chapter-number'>3</span>  <span class='chapter-title'>Нейронные сети в экологии: практическое введение</span>"
    ]
  },
  {
    "objectID": "chapter 2.html#загрузка-данных-и-первичный-осмотр",
    "href": "chapter 2.html#загрузка-данных-и-первичный-осмотр",
    "title": "3  Анализ и визуализация данных съемок",
    "section": "3.2 Загрузка данных и первичный осмотр",
    "text": "3.2 Загрузка данных и первичный осмотр\nТекст. Текст. Текст.",
    "crumbs": [
      "<span class='chapter-number'>3</span>  <span class='chapter-title'>Анализ и визуализация данных съемок</span>"
    ]
  },
  {
    "objectID": "chapter 2.html#описательная-статистика-и-визуализация",
    "href": "chapter 2.html#описательная-статистика-и-визуализация",
    "title": "3  Анализ и визуализация данных съемок",
    "section": "3.3 Описательная статистика и визуализация",
    "text": "3.3 Описательная статистика и визуализация\nТекст. Текст. Текст.",
    "crumbs": [
      "<span class='chapter-number'>3</span>  <span class='chapter-title'>Анализ и визуализация данных съемок</span>"
    ]
  },
  {
    "objectID": "chapter 3.html#загрузка-данных-и-первичный-осмотр",
    "href": "chapter 3.html#загрузка-данных-и-первичный-осмотр",
    "title": "4  От регрессии и до нейронных сетей",
    "section": "4.2 Загрузка данных и первичный осмотр",
    "text": "4.2 Загрузка данных и первичный осмотр\nТекст. Текст. Текст.",
    "crumbs": [
      "<span class='chapter-number'>4</span>  <span class='chapter-title'>От регрессии и до нейронных сетей</span>"
    ]
  },
  {
    "objectID": "chapter 3.html#описательная-статистика-и-визуализация",
    "href": "chapter 3.html#описательная-статистика-и-визуализация",
    "title": "4  От регрессии и до нейронных сетей",
    "section": "4.3 Описательная статистика и визуализация",
    "text": "4.3 Описательная статистика и визуализация\nТекст. Текст. Текст.",
    "crumbs": [
      "<span class='chapter-number'>4</span>  <span class='chapter-title'>От регрессии и до нейронных сетей</span>"
    ]
  },
  {
    "objectID": "chapter 2.html#раздел",
    "href": "chapter 2.html#раздел",
    "title": "3  Нейронные сети в экологии: практическое введение",
    "section": "3.2 Раздел",
    "text": "3.2 Раздел\nТекст. Текст. Текст.",
    "crumbs": [
      "<span class='chapter-number'>3</span>  <span class='chapter-title'>Нейронные сети в экологии: практическое введение</span>"
    ]
  },
  {
    "objectID": "chapter 2.html#раздел-1",
    "href": "chapter 2.html#раздел-1",
    "title": "3  Нейронные сети в экологии: практическое введение",
    "section": "3.3 Раздел",
    "text": "3.3 Раздел\nТекст. Текст. Текст.",
    "crumbs": [
      "<span class='chapter-number'>3</span>  <span class='chapter-title'>Нейронные сети в экологии: практическое введение</span>"
    ]
  },
  {
    "objectID": "chapter 2.html#выявление-аутлайеров",
    "href": "chapter 2.html#выявление-аутлайеров",
    "title": "3  Нейронные сети в экологии: практическое введение",
    "section": "3.4 Выявление аутлайеров",
    "text": "3.4 Выявление аутлайеров\nТекст. Текст. Текст.",
    "crumbs": [
      "<span class='chapter-number'>3</span>  <span class='chapter-title'>Нейронные сети в экологии: практическое введение</span>"
    ]
  },
  {
    "objectID": "chapter 1.html#определение-возрастной-структуры-статистические-методы-анализа-размерных-данных",
    "href": "chapter 1.html#определение-возрастной-структуры-статистические-методы-анализа-размерных-данных",
    "title": "2  Анализ и визуализация данных улова",
    "section": "2.5 Определение возрастной структуры: статистические методы анализа размерных данных",
    "text": "2.5 Определение возрастной структуры: статистические методы анализа размерных данных\nВозрастная структура популяции — часто важна для расчёта промысловой смертности, оценки репродуктивного потенциала и прогнозирования динамики запасов. Поскольку прямое измерение возраста часто невозможно (например, у беспозвоночных или рыб без четких возрастных меток), используются статистические методы, выделяющие группы в смешанных распределениях размеров.\nОсновные подходы:\n\nМетод k-средних (k-means) — алгоритм кластеризации, группирующий особи в заданное число кластеров (возрастных групп) на основе их размеров.\nМетод Бхаттачарии — статистический подход для разделения смешанных нормальных распределений, часто применяемый для идентификации мод в гистограммах.\nEM-алгоритм — оценка параметров смеси распределений, подходящая для данных с перекрывающимися возрастными группами.\nГауссовы смеси (GMM) — расширение метода Бхаттачарии для многомерного анализа.\nЯдерное сглаживание — непараметрический метод визуализации плотности, помогающий выявить скрытые моды.\n\nРассмотрим метод k-средних (k-means) и метод Бхаттачарии, предварительно построив гистограмму.\n\n# Загрузка библиотек\nlibrary(tidyverse)\nlibrary(mixtools)\n# Гистограмма длины с наложением плотности\nggplot(data, aes(x = length)) +\n  geom_histogram(aes(y = after_stat(density)), fill = \"steelblue\", bins = 20, alpha = 0.7) +\n  geom_density(color = \"#FC4E07\", linewidth = 1) +\n  labs(title = \"Распределение длины карапакса\", \n       subtitle = \"Пики могут соответствовать возрастным группам\",\n       x = \"Длина (мм)\")\n\n\n\n\nРис. 1.3: Распределение длины карапакса\n\n\n\n# Кластеризация по длине (K-means как пример)\nset.seed(123)\nclusters &lt;- kmeans(data$length, centers = 4)  # Предполагаем 4 возрастные группы\ndata$cluster &lt;- factor(clusters$cluster)\n\n# Визуализация кластеров\nggplot(data, aes(x = length, fill = cluster)) +\n  geom_histogram(bins = 25, alpha = 0.7) +\n  labs(title = \"Кластеризация по длине)\", \n       x = \"Длина (мм)\")\n\n\n\n\nРис. 1.4: Кластеризация по длине\n\n\n\n# Установка рабочей директории\nsetwd(\"C:/TEXTBOOK/\")\n\n# Загрузка библиотек\nlibrary(tidyverse)\nlibrary(mixtools)\n\n# Загрузка данных\ndata &lt;- read.csv(\"shrimp_catch.csv\")\n\n# 1. Построение и отображение гистограммы\nhist(data$length, breaks = 20, main = \"Гистограмма распределения длин карапаксов\",\n     xlab = \"Длина карапакса (мм)\", ylab = \"Частота\")\n\n# 2. Инициализация параметров (предположим 4 возрастные группы)\ninit_params &lt;- list(\n  lambda = rep(1/4, 4),\n  mu = c(13, 19, 25, 32),\n  sigma = c(1.5, 1.75, 1.75, 2.5)\n)\n\n# 3. Разделение смеси распределений методом EM\nfit &lt;- normalmixEM(data$length, k = 4, maxit = 1000, epsilon = 1e-3,\n                   lambda = init_params$lambda,\n                   mu = init_params$mu,\n                   sigma = init_params$sigma)\n\n# 4. Визуализация результатов с ggplot2\n# Генерация сетки для построения кривых\nx_grid &lt;- seq(min(data$length), max(data$length), length.out = 500)\n\n# Функция смеси\nmixture_density &lt;- function(x) {\n  fit$lambda[1] * dnorm(x, fit$mu[1], fit$sigma[1]) +\n  fit$lambda[2] * dnorm(x, fit$mu[2], fit$sigma[2]) +\n  fit$lambda[3] * dnorm(x, fit$mu[3], fit$sigma[3]) +\n  fit$lambda[4] * dnorm(x, fit$mu[4], fit$sigma[4])\n}\n\n# График\nggplot(data, aes(x = length)) +\n  # Гистограмма\n  geom_histogram(aes(y = after_stat(density)), bins = 20, fill = \"white\", color = \"black\", alpha = 0.7) +\n  # Исходное распределение (гладкая линия)\n  geom_density(color = \"red\", lwd = 1.2) +\n  # Смесь распределений\n  stat_function(fun = mixture_density, color = \"black\", lwd = 1.5) +\n  # Компоненты смеси\n  stat_function(fun = function(x) fit$lambda[1] * dnorm(x, fit$mu[1], fit$sigma[1]), color = \"blue\", lwd = 1) +\n  stat_function(fun = function(x) fit$lambda[2] * dnorm(x, fit$mu[2], fit$sigma[2]), color = \"green\", lwd = 1) +\n  stat_function(fun = function(x) fit$lambda[3] * dnorm(x, fit$mu[3], fit$sigma[3]), color = \"orange\", lwd = 1) +\n  stat_function(fun = function(x) fit$lambda[4] * dnorm(x, fit$mu[4], fit$sigma[4]), color = \"purple\", lwd = 1) +\n  \n  # Настройка темы и легенды\n  theme_minimal() +\n  labs(\n    x = \"Длина карапакса (мм)\",\n    y = \"Плотность\",\n    title = \"Разделение возрастных групп методом EM\"\n  )\n\n\n\n\nРис. 1.5: Метод Бхаттачарии",
    "crumbs": [
      "<span class='chapter-number'>2</span>  <span class='chapter-title'>Анализ и визуализация данных улова</span>"
    ]
  },
  {
    "objectID": "chapter 1.html#выявление-аутлайеров-выбросы",
    "href": "chapter 1.html#выявление-аутлайеров-выбросы",
    "title": "2  Анализ и визуализация данных улова",
    "section": "2.4 Выявление аутлайеров (выбросы)",
    "text": "2.4 Выявление аутлайеров (выбросы)\nАутлаеры (выбросы) — наблюдения, значительно отклоняющиеся от общего распределения данных. Их идентификация критически важна, так как они могут искажать результаты анализа. Один из надёжных методов обнаружения выбросов — метод межквартильного размаха (IQR).\n\n2.4.1 Теория метода\n\nРасчёт квартилей:\n\nQ1 (25-й перцентиль): значение, ниже которого находится 25% данных.\nQ3 (75-й перцентиль): значение, ниже которого находится 75% данных.\nIQR = Q3 - Q1: мера разброса средней половины данных.\n\nГраницы аутлаеров:\n\nНижняя граница: Q1−1.5×IQRQ1−1.5×IQR\nВерхняя граница: Q3+1.5×IQRQ3+1.5×IQR\nНаблюдения за этими пределами считаются выбросами.\n\n\n\n\n2.4.2 Преимущества метода\n\nУстойчивость к асимметрии распределения.\nНе требует предположения о нормальности данных.\n\n\n# Метод межквартильного размаха\noutliers &lt;- data %&gt;%\n  mutate(\n    length_z = scale(length),\n    weight_z = scale(weight)\n  ) %&gt;% \n  filter(abs(length_z) &gt; 3 | abs(weight_z) &gt; 3)\n\n# Визуализация\nggplot(data, aes(x = length, y = weight)) +\n  geom_point(aes(color = \"Обычные\"), alpha = 0.5) +\n  geom_point(data = outliers, aes(color = \"Аутлаеры\"), size = 3) +\n  scale_color_manual(values = c(\"Обычные\" = \"grey50\", \"Аутлаеры\" = \"red\")) +\n  labs(title = \"Выявление аномальных наблюдений\", color = \"Тип\")\n\n\n\n\nРис. 1.3: Распределение длины карапакса",
    "crumbs": [
      "<span class='chapter-number'>2</span>  <span class='chapter-title'>Анализ и визуализация данных улова</span>"
    ]
  },
  {
    "objectID": "chapter 1.html#уравнение-берталанфи",
    "href": "chapter 1.html#уравнение-берталанфи",
    "title": "2  Анализ и визуализация данных улова",
    "section": "2.6 Уравнение Берталанфи",
    "text": "2.6 Уравнение Берталанфи\nУравнение Берталанфи — фундаментальная модель в рыбохозяйственной науке, описывающая асимптотический рост организмов. Оно имеет вид: \\[\nL(t) = L_{\\infty} \\cdot \\left(1 - e^{-k \\cdot (t - t_0)}\\right)\n\\] где L∞— теоретическая максимальная длина особи, k— коэффициент скорости роста, t0— гипотетический возраст при нулевой длине.\nВ приведённом коде модель применяется для анализа роста северной креветки :\n\nПодготовка данных: Удаление аутлаеров (например, строк 10 и 50) повышает точность оценки параметров.\nИнициализация параметров:\n\nL∞ задаётся как максимальная наблюдаемая длина в данных.\nk и t0 подбираются итеративно методом нелинейных наименьших квадратов (nls).\n\nВизуализация: График сопоставляет эмпирические данные (точки) с предсказаниями модели (красная линия), демонстрируя, как рост замедляется с приближением к L∞.\n\nИнтерпретация параметров:\n\nВысокое значение k (&gt;0.3) указывает на быстрый рост молоди.\nt0&lt;0 может отражать ранний метаморфоз личинок.\n\n\n# Загрузка библиотек\nlibrary(ggplot2)\nlibrary(dplyr)\nlibrary(nlme)\n\n# Загрузка данных\ndata &lt;- read.csv(\"shrimp_catch.csv\")\n\n# Преобразование возраста в числовой формат\ndata$age_num &lt;- as.numeric(data$age)\n\n# Удаление аутлайеров (если необходимо)\ndata_clean &lt;- data %&gt;%\n  filter(!id %in% c(10, 50))  # Пример удаления строк с аномалиями\n\n# Начальные параметры на основе данных\nL_inf_start &lt;- max(data_clean$length, na.rm = TRUE)  # Максимальная длина\nk_start &lt;- 0.3                                        # Средняя скорость роста\nt0_start &lt;- -0.5                                      # Гипотетический возраст\n\n# Подгонка модели с увеличенным числом итераций\nmodel &lt;- nls(\n  length ~ L_inf * (1 - exp(-k * (age_num - t0))),\n  data = data_clean,\n  start = list(L_inf = L_inf_start, k = k_start, t0 = t0_start),\n  control = nls.control(maxiter = 200, warnOnly = TRUE)  # Увеличиваем лимит итераций\n)\n\n# Вывод результатов\nsummary(model)\n\n# Создание последовательности возрастов для предсказания\nage_seq &lt;- seq(min(data_clean$age_num), max(data_clean$age_num), by = 0.1)\n\n# Предсказание значений длины\nlength_pred &lt;- predict(model, newdata = data.frame(age_num = age_seq))\n\n# Построение графика\nggplot(data_clean, aes(x = age_num, y = length)) +\n  geom_point(aes(color = age), alpha = 0.7) +\n  geom_line(data = data.frame(age_num = age_seq, length = length_pred), \n            aes(x = age_num, y = length), color = \"red\", linewidth = 1.2) +\n  labs(\n    title = \"Рост креветок по уравнению Берталанфи\",\n    x = \"Возраст (годы)\",\n    y = \"Длина карапакса (мм)\",\n    color = \"Возрастная группа\"\n  ) +\n  theme_minimal()\n\n# Сохранение графика\nggsave(\"bertalanffy_model.png\", width = 8, height = 6)\n\n\n\n\nРис. 1.6: Рост креветок по уравнению Берталанфи",
    "crumbs": [
      "<span class='chapter-number'>2</span>  <span class='chapter-title'>Анализ и визуализация данных улова</span>"
    ]
  },
  {
    "objectID": "chapter 1.html#огива-логистическая-кривая-и-50-ное-созревание",
    "href": "chapter 1.html#огива-логистическая-кривая-и-50-ное-созревание",
    "title": "2  Анализ и визуализация данных улова",
    "section": "2.7 Огива, логистическая кривая и 50%-ное созревание",
    "text": "2.7 Огива, логистическая кривая и 50%-ное созревание\nЛогистическая кривая — ключевой инструмент для моделирования бинарных процессов, таких как созревание или смена пола у организмов. В случае протоандрических креветок (Pandalus borealis), которые меняют пол с возрастом, зависимость вероятности быть самкой от длины карапакса можно описать логистической функцией:\n\\[\nP(F) = \\frac{1}{1 + e^{-(\\beta_0 + \\beta_1 \\cdot длина)}}\n\\]\nгде P(F) — вероятность принадлежности к женскому полу, β0 — интерсепт, β1 — коэффициент влияния длины.\nТочка перегиба логистической кривой соответствует длине, при которой вероятность быть самкой равна 50%: \\[\nL_{50} = -\\frac{\\beta_0}{\\beta_1}\n\\]\n\n\n\nРис. 1.7: Логистическая кривая\n\n\nОгива (кумулятивная кривая) показывает накопление вероятности с увеличением длины. Для анализа созревания её можно построить через интеграл логистической функции. Визуально она демонстрирует, как доля самок возрастает с размером.\n\n\n\nРис. 1.8: Огива\n\n\n\n2.7.1 Оценка модели\n\nROC-кривая и AUC:\n\nПлощадь под ROC-кривой (AUC) &gt;0.7 указывает на хорошую предсказательную способность модели.\nЗначение AUC = 0.94(пример из кода) подтверждает сильную связь длины и пола.\n\n\n\n\n\nРис. 1.9: ROC-кривая и AUC\n\n\n\nИнтерпретация коэффициентов:\n\nПоложительный β1 означает: с ростом длины вероятность быть самкой увеличивается.\nНапример, β1=0.25 → увеличение длины на 1 мм повышает шансы в e0.25≈1.28 раза.\n\n\n\n\n2.7.2 Биологический контекст\n\nПротоандрический гермафродитизм: У креветок смена пола с самцов на самок происходит при достижении критического размера (~25-28 мм).\nL50 как индикатор: Снижение L50 в популяции может сигнализировать о стрессовых условиях (перелов, изменение среды), ускоряющих созревание.\n\n\n# Установка рабочей директории\nsetwd(\"C:/TEXTBOOK/\")\n\n# Загрузка библиотек\nlibrary(tidyverse)\nlibrary(pROC)\nlibrary(ggplot2)\n\n# Загрузка данных\ndata &lt;- read_csv(\"shrimp_catch.csv\")\n\n# 1. Предобработка данных -----------------------------------------------------\n# Удаление аутлаеров методом IQR\nQ1 &lt;- quantile(data$length, 0.25)\nQ3 &lt;- quantile(data$length, 0.75)\nIQR &lt;- Q3 - Q1\ndata_clean &lt;- data %&gt;%\n  filter(length &gt;= Q1 - 1.5*IQR & length &lt;= Q3 + 1.5*IQR)\n\n# 2. Логистическая регрессия --------------------------------------------------\n# Преобразование пола в бинарную переменную\ndata_clean$sex_binary &lt;- ifelse(data_clean$sex == \"F\", 1, 0)\n\n# Подгонка модели\nmodel_logit &lt;- glm(sex_binary ~ length, \n                   data = data_clean, \n                   family = binomial(link = \"logit\"))\n\n# Расчет коэффициентов\nbeta0 &lt;- coef(model_logit)[1]\nbeta1 &lt;- coef(model_logit)[2]\n\n# Вычисление L50 (длина 50% созревания)\nL50 &lt;- round(-beta0/beta1, 1)\n\n# 3. Визуализация ------------------------------------------------------------\n# Логистическая кривая\nggplot(data_clean, aes(x = length, y = sex_binary)) +\n  geom_point(aes(color = sex), alpha = 0.6, size = 2) +\n  geom_line(aes(y = predict(model_logit, type = \"response\")), \n            color = \"#D81B60\", linewidth = 1.5) +\n  geom_vline(xintercept = L50, linetype = \"dashed\", color = \"#1E88E5\") +\n  annotate(\"text\", x = L50 + 2, y = 0.2, \n           label = paste(\"L50 =\", L50, \"мм\"), color = \"#1E88E5\") +\n  scale_color_manual(values = c(\"#FFC107\", \"#1976D2\")) +\n  labs(\n    title = \"Зависимость пола от длины карапакса\",\n    subtitle = \"Логистическая регрессия с 50%-ной точкой созревания\",\n    x = \"Длина карапакса (мм)\",\n    y = \"Вероятность быть самкой (P(F))\"\n  ) +\n  theme_minimal(base_size = 12)\n\n# Огива (кумулятивное распределение)\ndata_ogive &lt;- data_clean %&gt;%\n  arrange(length) %&gt;%\n  mutate(\n    cum_females = cumsum(sex_binary),\n    cum_prob = cum_females / max(cum_females)\n  )\n\nggplot(data_ogive, aes(x = length, y = cum_prob)) +\n  geom_line(color = \"#4CAF50\", linewidth = 1.5) +\n  geom_vline(xintercept = L50, linetype = \"dashed\", color = \"#1E88E5\") +\n  geom_hline(yintercept = 0.5, linetype = \"dotted\", color = \"#757575\") +\n  annotate(\"text\", x = L50 + 2, y = 0.55, \n           label = paste(\"50% созревание при\", L50, \"мм\"), color = \"#1E88E5\") +\n  scale_y_continuous(labels = scales::percent) +\n  labs(\n    title = \"Огива: Кумулятивное распределение самок\",\n    x = \"Длина карапакса (мм)\",\n    y = \"Накопленная доля самок\"\n  ) +\n  theme_minimal(base_size = 12)\n\n# 4. Оценка модели -----------------------------------------------------------\n# ROC-анализ\nroc_obj &lt;- roc(data_clean$sex_binary, predict(model_logit, type = \"response\"))\nauc_value &lt;- round(auc(roc_obj), 2)\n\n# График ROC-кривой\nplot(roc_obj, col = \"#E53935\", main = paste(\"ROC-кривая (AUC =\", auc_value, \")\"))\n\n# 5. Сохранение результатов --------------------------------------------------\nggsave(\"logistic_curve.png\", width = 8, height = 6, dpi = 300)\nggsave(\"ogive_curve.png\", width = 8, height = 6, dpi = 300)\n\n# Вывод ключевых метрик\ncat(\"Результаты анализа:\\n\")\ncat(\"- Длина 50%-ного созревания (L50):\", L50, \"мм\\n\")\ncat(\"- AUC модели:\", auc_value, \"\\n\")\ncat(\"- Коэффициенты модели:\\n\")\ncat(\"  Intercept (β0):\", round(beta0, 2), \"\\n\")\ncat(\"  Slope (β1):\", round(beta1, 2), \"\\n\")",
    "crumbs": [
      "<span class='chapter-number'>2</span>  <span class='chapter-title'>Анализ и визуализация данных улова</span>"
    ]
  },
  {
    "objectID": "chapter 1.html#сравнение-групп",
    "href": "chapter 1.html#сравнение-групп",
    "title": "2  Анализ и визуализация данных улова",
    "section": "2.8 Сравнение групп",
    "text": "2.8 Сравнение групп",
    "crumbs": [
      "<span class='chapter-number'>2</span>  <span class='chapter-title'>Анализ и визуализация данных улова</span>"
    ]
  },
  {
    "objectID": "chapter 1.html#моделирование-и-прогнозирование",
    "href": "chapter 1.html#моделирование-и-прогнозирование",
    "title": "2  Анализ и визуализация данных улова",
    "section": "2.9 Моделирование и прогнозирование",
    "text": "2.9 Моделирование и прогнозирование",
    "crumbs": [
      "<span class='chapter-number'>2</span>  <span class='chapter-title'>Анализ и визуализация данных улова</span>"
    ]
  },
  {
    "objectID": "chapter 1.html#сравнение-групп-и-параметров",
    "href": "chapter 1.html#сравнение-групп-и-параметров",
    "title": "2  Анализ и визуализация данных улова",
    "section": "2.8 Сравнение групп и параметров",
    "text": "2.8 Сравнение групп и параметров",
    "crumbs": [
      "<span class='chapter-number'>2</span>  <span class='chapter-title'>Анализ и визуализация данных улова</span>"
    ]
  },
  {
    "objectID": "chapter 1.html#сравнение-групп-параметров-моделей",
    "href": "chapter 1.html#сравнение-групп-параметров-моделей",
    "title": "2  Анализ и визуализация данных улова",
    "section": "2.8 Сравнение групп, параметров, моделей",
    "text": "2.8 Сравнение групп, параметров, моделей\n\n2.8.1 Сравнение групп (на примере самцов и самок)\nРассмотрим методы сравнения количественных характеристик (длина, вес) между самцами и самками северной креветки. Анализ включает проверку нормальности распределения, выбор подходящего статистического теста и визуализацию различий.\n\n2.8.1.1 Подготовка данных\nЗагрузим данные и выделим подвыборки для самцов и самок:\n\n# Установка рабочей директории\nsetwd(\"C:/TEXTBOOK/\")\n\n# Загрузка библиотек  \nlibrary(tidyverse)  \nlibrary(ggplot2)  \nlibrary(rstatix)\nlibrary(ggpubr)\n\n# Загрузка данных  \ndata &lt;- read_csv(\"shrimp_catch.csv\") %&gt;%\n  filter(!id %in% c(10, 50))  # Удаление аномальных наблюдений \n\n# Фильтрация данных по полу  \nmales &lt;- data %&gt;% filter(sex == \"M\")  \nfemales &lt;- data %&gt;% filter(sex == \"F\") \n\n\n\n2.8.1.2 Проверка нормальности распределения\nПеред сравнением групп проверим, соответствуют ли данные нормальному распределению (тест Шапиро-Уилка):\n\n# Проверка нормальности для длины самцов  \nshapiro_test(males$length)  \n# Проверка нормальности для длины самок  \nshapiro_test(females$length) \n\nЕсли p-value &gt; 0.05, распределение считается нормальным. В противном случае используем непараметрические методы.\n\n\n2.8.1.3 Сравнение средних значений\nЕсли данные нормальны: t-тест\n\n# T-тест для сравнения длин самцов и самок  \nt_test_result &lt;- t_test(length ~ sex, data = data)  \nt_test_result \n\nЕсли данные не нормальны: U-тест Манна-Уитни\n\n# U-тест для сравнения длин самцов и самок  \nmannwhitney_result &lt;- wilcox_test(length ~ sex, data = data)  \nmannwhitney_result \n\n\n\n2.8.1.4 Эффект размера (коэффициент Коэна)\nДля оценки практической значимости различий рассчитаем коэффициент Коэна:\n\n# Расчет коэффициента Коэна  \ncohens_d_result &lt;- cohens_d(length ~ sex, data = data)  \ncohens_d_result  \n\n\nd &lt; 0.2 : малый эффект,\nd ≈ 0.5 : средний эффект,\nd &gt; 0.8 : большой эффект.\n\n\n\n2.8.1.5 Визуализация различий\nПостроим boxplot для визуального сравнения длин самцов и самок:\n\nggplot(data, aes(x = sex, y = length, fill = sex)) +  \n  geom_boxplot(color = \"black\", alpha = 0.7) +  \n  stat_compare_means(method = \"t.test\") +  # Добавление p-value  \n  labs(title = \"Сравнение длин самцов и самок\",  \n       x = \"Пол\", y = \"Длина карапакса (мм)\") +  \n  theme_minimal() \n\n\n\n\nРис. 1.10: Boxplot сравнения длин самцов и самок\n\n\n\n\n2.8.1.6 Интерпретация результатов\n\nЕсли p-value &lt; 0.05, различия между группами статистически значимы.\nЭффект размера помогает оценить биологическую важность различий. Например, если самки значительно крупнее самцов (d = 1.2), это может указывать на половой диморфизм, связанный с репродуктивной стратегией.\n2.8.1.7 Пример полного анализа для веса\n\n\n# Полный анализ для веса  \nweight_analysis &lt;- data %&gt;%  \n  group_by(sex) %&gt;%  \n  summarise(  \n    mean_weight = mean(weight),  \n    sd_weight = sd(weight),  \n    n = n()  \n  ) %&gt;%  \n  mutate(  \n    t_test = list(t_test(weight ~ sex, data = data)),  \n    cohens_d = list(cohens_d(weight ~ sex, data = data))  \n  )  \n\n# Вывод результатов  \nprint(weight_analysis) \n\n# Распределение веса по полу\nggplot(data, aes(x = factor(sex), y = weight, fill = factor(sex))) +\n  geom_violin(trim = FALSE, alpha = 0.7) +\n  geom_boxplot(width = 0.2, outlier.shape = NA, fill = \"white\") +\n  labs(title = \"Распределение веса по полу\", x = \"Пол\", y = \"Вес (г)\") +\n  theme_minimal()\n\n\n\n\nРис. 1.12: Violin plot для визуализации распределения веса\n\n\n\n\n2.8.1.8 Выводы\n\nИспользуйте t-тест для нормальных данных и U-тест для ненормальных.\nДополните анализ оценкой эффекта размера для биологической интерпретации.\nВизуализируйте различия с помощью boxplot или violin plot.\n\nРекомендации :\n\nДля многомерных данных (например, одновременное сравнение длины, веса и возраста) применяйте MANOVA.\nЕсли группы неоднородны (например, разный возрастной состав), используйте ковариационный анализ (ANCOVA).\n2.8.2 Что делать, если тест на нормальность не пройден для одной из групп?\nПри сравнении количественных характеристик (например, длины карапакса у самцов и самок) важно учитывать, соответствуют ли данные нормальному распределению. Если тест на нормальность (например, Шапиро-Уилка) показывает значимое отклонение от нормальности для одной из групп, это влияет на выбор статистического теста и интерпретацию результатов.\n2.8.2.1 Пример из нашего анализа\nМы провели сравнение длины карапакса между самцами и самками:\n\nДля самцов: shapiro_test(males$length) → p-value = 0.000574 (нормальность отвергнута).\nДля самок: shapiro_test(females$length) → p-value = 0.891 (нормальность подтверждена).\n\nНесмотря на это, мы применили как t-тест , так и U-тест Манна-Уитни :\n\nt-тест : p-value = 1.46e-40 (значимо).\nU-тест : p-value = 1.97e-27 (значимо).\nКоэффициент Коэна: d = 2.14 (большой эффект).\n\n2.8.2.2 Почему это работает?\n\nt-тест устойчив к умеренным отклонениям от нормальности :\n\nПри больших выборках (n &gt; 30) центральная предельная теорема позволяет использовать t-тест даже при слабо выраженной асимметрии.\nВ вашем случае выборка самцов (n = 149) достаточно велика, чтобы компенсировать отклонение от нормальности.\n\nU-тест Манна-Уитни — непараметрическая альтернатива :\n\nЭтот тест не требует нормальности и сравнивает ранги, а не средние значения.\nОн подтверждает значимость различий, что усиливает доверие к выводу.\n\nЭффект размера (коэффициент Кобена) :\n\nd = 2.14 указывает на большой эффект , что важно для биологической интерпретации, даже если p-values значимы.\n\n\n\n\n\n\n2.8.3 Сравнение параметров (линейные модели для оценки межгрупповых различий)\nДля сравнения параметров двух линейных моделей (например, скорости роста самцов и самок) используем следующий подход.\n\n# Установка рабочей директории\nsetwd(\"C:/TEXTBOOK/\")\n\n# Загрузка библиотек\nlibrary(tidyverse)\nlibrary(ggplot2)\nlibrary(broom)\nlibrary(knitr)\n\n# Загрузка данных\ndata &lt;- read_csv(\"shrimp_catch.csv\") %&gt;%\n  filter(!id %in% c(10, 50))  # Удаление аномальных наблюдений\n\n# Фильтрация данных по полу\ndata_male &lt;- data %&gt;% filter(sex == \"M\")\ndata_female &lt;- data %&gt;% filter(sex == \"F\")\n\n# Построение моделей\nmodel_male &lt;- lm(length ~ age, data = data_male)\nmodel_female &lt;- lm(length ~ age, data = data_female)\n\nggplot(data, aes(age, length, color = sex)) +\n  geom_point(alpha = 0.5) +\n  geom_smooth(method = \"lm\", formula = y ~ x) +\n  scale_color_manual(values = c(\"#E7B800\", \"#00AFBB\")) +\n  labs(x = \"Возраст\", y = \"Длина (мм)\") +\n  theme_minimal()\n\n\n\n\nРис. 1.15: Визуализация моделей\n\n\nМетод 1: Объединенная модель с взаимодействиями\n\n# Установка рабочей директории\njoint_model &lt;- lm(length ~ age * sex, data = data)\nsummary(joint_model) %&gt;% \n  broom::tidy() %&gt;% \n  filter(term == \"age:sexM\") %&gt;% \n  kable(caption = \"Проверка различия наклонов\", digits = 3)\n\n\nTable: Проверка различия наклонов\n\n|term     | estimate| std.error| statistic| p.value|\n|:--------|--------:|---------:|---------:|-------:|\n|age:sexM |     1.86|     0.459|     4.053|       0|\n&gt; \n\nИнтерпретация:\nЗначимый коэффициент взаимодействия age:sexM (p &lt; 0.05) указывает на статистически значимые различия в скорости роста между полами.\nМетод 2: Тест Вальда\n\nlibrary(car)\ndelta_beta &lt;- coef(model_male)[\"age\"] - coef(model_female)[\"age\"]\nse_diff &lt;- sqrt(vcov(model_male)[\"age\",\"age\"] + vcov(model_female)[\"age\",\"age\"])\nz_score &lt;- delta_beta / se_diff\np_value &lt;- 2 * pnorm(-abs(z_score))\n\ncat(\"Разница коэффициентов:\", round(delta_beta, 3), \n    \"\\nZ-статистика:\", round(z_score, 3),\n    \"\\np-value:\", format.pval(p_value, digits = 2))\n\n\ncomparison_table &lt;- data.frame(\n  Параметр = c(\"Скорость роста самцов\", \"Скорость роста самок\", \"Разница\"),\n  Значение = c(\n    round(coef(model_male)[\"age\"], 2),\n    round(coef(model_female)[\"age\"], 2),\n    round(delta_beta, 2)\n  ),\n  `p-value` = c(\n    format.pval(summary(model_male)$coefficients[\"age\",4], digits = 2),\n    format.pval(summary(model_female)$coefficients[\"age\",4], digits = 2),\n    format.pval(p_value, digits = 2)\n  )\n)\nkable(comparison_table, caption = \"Сравнение коэффициентов роста\")\n\nВывод\n\n: Сравнение коэффициентов роста\n\n|Параметр              | Значение|p.value |\n|:---------------------|--------:|:-------|\n|Скорость роста самцов |     5.95|&lt;2e-16  |\n|Скорость роста самок  |     4.09|5.2e-13 |\n|Разница               |     1.86|0.00024 |\n&gt; \n\nИнтерпретация:\nЗначимая разница (p &lt; 0.05) указывает на статистически значимые различия в скорости роста между полами.\n\n\n2.8.4 Сравнение моделей\nОдним из ключевых аспектов анализа биологических данных является определение формы зависимости между переменными. В данном разделе мы рассмотрим основы подбора модели зависимости между длиной и весом креветок. Начиная с простой линейной модели, мы постепенно перейдем к более сложным нелинейным моделям, чтобы продемонстрировать методику выбора наилучшей модели. Cравним три модели — линейную, полиномиальную и степенную — чтобы определить, какая из них наилучшим образом описывает данные. Цель анализа — найти математическую зависимость, которая:\n\nТочно предсказывает вес креветки по её длине.\nИмеет биологическую интерпретацию.\nМинимизирует ошибку предсказания.\n\n\n2.8.4.1 Модели и их параметры\n\nЛинейная: \\(\\text{weight} = \\beta_0 + \\beta_1\\cdot\\text{length}\\)\nПолиномиальная 3-й степени: \\(\\text{weight} = \\beta_0 + \\beta_1\\cdot\\text{length} + \\beta_2\\cdot\\text{length}^2 + \\beta_3\\cdot\\text{length}^3\\)\nСтепенная: \\(\\text{weight} = a\\cdot\\text{length}^b\\)\n\n\n\n2.8.4.2 Метрики\n\nR² - (коэффициент детерминации): чем ближе к 1, тем лучше модель объясняет данные.\nAIC -(информационный критерий Акаике): чем меньше значение, тем лучше модель с учётом её сложности.\n\n\n\n2.8.4.3 Результаты\n\n2.8.4.3.1 1. Линейная модель\n\nCoefficients:\n             Estimate Std. Error t value Pr(&gt;|t|)    \n(Intercept) -2.115      0.085     -24.86   &lt;2e-16 ***\nlength       0.1665     0.0038    43.71    &lt;2e-16 ***\n\n\nR² = 0.894\nAIC = 148.02\n\n\n\n\nРис. 1.5: Линейная модель\n\n\n\n\n2.8.4.3.2 2. Полиномиальная модель\n\nCoefficients:\n                 Estimate Std. Error t value Pr(&gt;|t|)    \npoly(length,3)1  14.5038    0.2127    68.18   &lt;2e-16 ***\npoly(length,3)2   3.7209    0.2127    17.49   &lt;2e-16 ***\npoly(length,3)3   0.9526    0.2127     4.48  1.2e-05 ***\n\n\nR² = 0.957\nAIC = -52.80\n\n\n\n\nРис. 1.5: Полиномиальная модель\n\n\n\n\n2.8.4.3.3 3. Степенная модель\n\nParameters:\n   Estimate Std. Error t value Pr(&gt;|t|)    \na 0.000157   0.000028    5.60  6.3e-08 ***\nb 2.920160   0.054102   53.98   &lt;2e-16 ***\n\n\nR² = 0.955\nAIC = -48.43 \n\n\n\n\n2.8.4.4 3. Сравнение моделей\n\n\n\nМодель\nR²\nAIC\n\n\n\n\nЛинейная\n0.894\n148.02\n\n\nПолиномиальная\n0.957\n-52.80\n\n\nСтепенная\n0.955\n-48.43\n\n\n\nВыводы:\n\nПолиномиальная модель демонстрирует наилучшие показатели (максимальный R² и минимальный AIC).\nСтепенная модель близка по качеству, но её параметр b≈2.92 близок к биологически ожидаемому значению 3 (вес пропорционален объёму).\nЛинейная модель существенно уступает по точности.\n\n\n\n2.8.4.5 4. Рекомендации\n\nДля прогнозирования используйте полиномиальную модель, так как она минимизирует ошибку.\nДля биологической интерпретации предпочтительна степенная модель: weight∝length2.92.\nИзбегайте переобучения: Полиномиальные модели высокой степени могут терять интерпретируемость.\n\n\n\n2.8.4.6 5. Визуализация остатков\nОстатки степенной модели распределены равномерно, что подтверждает её адекватность: \n\n\n2.8.4.7 Заключение\nДля анализа зависимости веса от длины северной креветки рекомендуется:\n\nПолиномиальная модель — для задач, требующих максимальной точности.\nСтепенная модель — для интерпретации биологических закономерностей.\n\nСкрипт вышеописанных событий:\n\n# Установка рабочей директории\nsetwd(\"C:/TEXTBOOK/\")\n\n# Загрузка библиотек\nlibrary(tidyverse)\nlibrary(ggplot2)\n\n# Загрузка данных\ndata &lt;- read_csv(\"shrimp_catch.csv\") %&gt;%\n  filter(!id %in% c(10, 50))  # Удаление аномальных наблюдений\n\n# Проверка структуры\nglimpse(data)\n\n# Линейная модель: вес ~ длина\nmodel_linear &lt;- lm(weight ~ length, data = data)\nsummary(model_linear)\n\n# Визуализация\nggplot(data, aes(x = length, y = weight)) +\n  geom_point(color = \"steelblue\", alpha = 0.7) +\n  geom_smooth(method = \"lm\", color = \"#FC4E07\") +\n  labs(title = \"Линейная модель\", x = \"Длина (мм)\", y = \"Вес (г)\")\n\n\n# Полиномиальная модель: вес ~ длина + длина? + длина?\nmodel_poly &lt;- lm(weight ~ poly(length, 3), data = data)\nsummary(model_poly)\n\n# Визуализация\nggplot(data, aes(x = length, y = weight)) +\n  geom_point(color = \"steelblue\", alpha = 0.7) +\n  geom_smooth(method = \"lm\", formula = y ~ poly(x, 3), color = \"#E7B800\") +\n  labs(title = \"Полиномиальная модель\", x = \"Длина (мм)\", y = \"Вес (г)\")\n\n\n# Степенная модель: вес ~ длина^k (k подбирается)\nmodel_power &lt;- nls(weight ~ a * length^b, \n                   data = data, \n                   start = list(a = 0.001, b = 3))  # Начальные значения\nsummary(model_power)\n\n# Визуализация\ndata$pred_power &lt;- predict(model_power)\nggplot(data, aes(x = length, y = weight)) +\n  geom_point(color = \"steelblue\", alpha = 0.7) +\n  geom_line(aes(y = pred_power), color = \"#00BA38\", linewidth = 1.2) +\n  labs(title = \"Степенная модель\", x = \"Длина (мм)\", y = \"Вес (г)\")\n\n# Расчет AIC\nAIC(model_linear, model_poly, model_power)\n\n# Расчет R?\nr2_linear &lt;- summary(model_linear)$r.squared\nr2_poly &lt;- summary(model_poly)$r.squared\nr2_power &lt;- 1 - sum(residuals(model_power)^2) / sum((data$weight - mean(data$weight))^2)\n\n# Создание таблицы сравнения моделей\ncomparison_table &lt;- data.frame(\n  Модель = c(\"Линейная\", \"Полиномиальная\", \"Степенная\"),\n  R_square = c(r2_linear, r2_poly, r2_power),\n  AIC = c(AIC(model_linear), AIC(model_poly), AIC(model_power))\n)\n\n# Вывод таблицы\nprint(comparison_table)\n\n# Остатки для степенной модели\ndata$residuals &lt;- residuals(model_power)\n\nggplot(data, aes(x = length, y = residuals)) +\n  geom_point(color = \"#FC4E07\", alpha = 0.7) +\n  geom_hline(yintercept = 0, linetype = \"dashed\") +\n  labs(title = \"Остатки степенной модели\", x = \"Длина (мм)\", y = \"Ошибка\")",
    "crumbs": [
      "<span class='chapter-number'>2</span>  <span class='chapter-title'>Анализ и визуализация данных улова</span>"
    ]
  },
  {
    "objectID": "chapter 1.html#заключение",
    "href": "chapter 1.html#заключение",
    "title": "2  Анализ и визуализация данных улова",
    "section": "2.9 Заключение",
    "text": "2.9 Заключение\n\nОбщая модель подтверждает нарастание полового диморфизма с возрастом\nПослойный анализ выявляет критический возраст (2 года) начала дифференциации\nБиологический механизм: Ускоренный рост самок после смены пола обеспечивает репродуктивное преимущество\n\n\n2.9.1 Сравнение моделей\nОдним из ключевых аспектов анализа биологических данных является определение формы зависимости между переменными. В данном разделе мы рассмотрим основы подбора модели зависимости между длиной и весом креветок. Начиная с простой линейной модели, мы постепенно перейдем к более сложным нелинейным моделям, чтобы продемонстрировать методику выбора наилучшей модели. Cравним три модели — линейную, полиномиальную и степенную — чтобы определить, какая из них наилучшим образом описывает данные. Цель анализа — найти математическую зависимость, которая:\n\nТочно предсказывает вес креветки по её длине.\nИмеет биологическую интерпретацию.\nМинимизирует ошибку предсказания.\n\n\n2.9.1.1 Модели и их параметры\n\nЛинейная: \\(\\text{weight} = \\beta_0 + \\beta_1\\cdot\\text{length}\\)\nПолиномиальная 3-й степени: \\(\\text{weight} = \\beta_0 + \\beta_1\\cdot\\text{length} + \\beta_2\\cdot\\text{length}^2 + \\beta_3\\cdot\\text{length}^3\\)\nСтепенная: \\(\\text{weight} = a\\cdot\\text{length}^b\\)\n\n\n\n2.9.1.2 Метрики\n\nR² - (коэффициент детерминации): чем ближе к 1, тем лучше модель объясняет данные.\nAIC -(информационный критерий Акаике): чем меньше значение, тем лучше модель с учётом её сложности.\n\n\n\n2.9.1.3 Результаты\n\n2.9.1.3.1 1. Линейная модель\n\nCoefficients:\n             Estimate Std. Error t value Pr(&gt;|t|)    \n(Intercept) -2.115      0.085     -24.86   &lt;2e-16 ***\nlength       0.1665     0.0038    43.71    &lt;2e-16 ***\n\n\nR² = 0.894\nAIC = 148.02\n\n\n\nРис. 1.5: Линейная модель\n\n\n\n\n\n2.9.1.3.2 2. Полиномиальная модель\n\nCoefficients:\n                 Estimate Std. Error t value Pr(&gt;|t|)    \npoly(length,3)1  14.5038    0.2127    68.18   &lt;2e-16 ***\npoly(length,3)2   3.7209    0.2127    17.49   &lt;2e-16 ***\npoly(length,3)3   0.9526    0.2127     4.48  1.2e-05 ***\n\n\nR² = 0.957\nAIC = -52.80\n\n\n\n\nРис. 1.5: Полиномиальная модель\n\n\n\n\n2.9.1.3.3 3. Степенная модель\n\nParameters:\n   Estimate Std. Error t value Pr(&gt;|t|)    \na 0.000157   0.000028    5.60  6.3e-08 ***\nb 2.920160   0.054102   53.98   &lt;2e-16 ***\n\n\nR² = 0.955\nAIC = -48.43 \n\n\n\n\n2.9.1.4 3. Сравнение моделей\n\n\n\nМодель\nR²\nAIC\n\n\n\n\nЛинейная\n0.894\n148.02\n\n\nПолиномиальная\n0.957\n-52.80\n\n\nСтепенная\n0.955\n-48.43\n\n\n\nВыводы:\n\nПолиномиальная модель демонстрирует наилучшие показатели (максимальный R² и минимальный AIC).\nСтепенная модель близка по качеству, но её параметр b≈2.92 близок к биологически ожидаемому значению 3 (вес пропорционален объёму).\nЛинейная модель существенно уступает по точности.\n\n\n\n2.9.1.5 4. Рекомендации\n\nДля прогнозирования используйте полиномиальную модель, так как она минимизирует ошибку.\nДля биологической интерпретации предпочтительна степенная модель: weight∝length2.92.\nИзбегайте переобучения: Полиномиальные модели высокой степени могут терять интерпретируемость.\n\n\n\n2.9.1.6 5. Визуализация остатков\nОстатки степенной модели распределены равномерно, что подтверждает её адекватность: \n\n\n2.9.1.7 Заключение\nДля анализа зависимости веса от длины северной креветки рекомендуется:\n\nПолиномиальная модель — для задач, требующих максимальной точности.\nСтепенная модель — для интерпретации биологических закономерностей.\n\nСкрипт вышеописанных событий:\n\n# Установка рабочей директории\nsetwd(\"C:/TEXTBOOK/\")\n\n# Загрузка библиотек\nlibrary(tidyverse)\nlibrary(ggplot2)\n\n# Загрузка данных\ndata &lt;- read_csv(\"shrimp_catch.csv\") %&gt;%\n  filter(!id %in% c(10, 50))  # Удаление аномальных наблюдений\n\n# Проверка структуры\nglimpse(data)\n\n# Линейная модель: вес ~ длина\nmodel_linear &lt;- lm(weight ~ length, data = data)\nsummary(model_linear)\n\n# Визуализация\nggplot(data, aes(x = length, y = weight)) +\n  geom_point(color = \"steelblue\", alpha = 0.7) +\n  geom_smooth(method = \"lm\", color = \"#FC4E07\") +\n  labs(title = \"Линейная модель\", x = \"Длина (мм)\", y = \"Вес (г)\")\n\n\n# Полиномиальная модель: вес ~ длина + длина? + длина?\nmodel_poly &lt;- lm(weight ~ poly(length, 3), data = data)\nsummary(model_poly)\n\n# Визуализация\nggplot(data, aes(x = length, y = weight)) +\n  geom_point(color = \"steelblue\", alpha = 0.7) +\n  geom_smooth(method = \"lm\", formula = y ~ poly(x, 3), color = \"#E7B800\") +\n  labs(title = \"Полиномиальная модель\", x = \"Длина (мм)\", y = \"Вес (г)\")\n\n\n# Степенная модель: вес ~ длина^k (k подбирается)\nmodel_power &lt;- nls(weight ~ a * length^b, \n                   data = data, \n                   start = list(a = 0.001, b = 3))  # Начальные значения\nsummary(model_power)\n\n# Визуализация\ndata$pred_power &lt;- predict(model_power)\nggplot(data, aes(x = length, y = weight)) +\n  geom_point(color = \"steelblue\", alpha = 0.7) +\n  geom_line(aes(y = pred_power), color = \"#00BA38\", linewidth = 1.2) +\n  labs(title = \"Степенная модель\", x = \"Длина (мм)\", y = \"Вес (г)\")\n\n# Расчет AIC\nAIC(model_linear, model_poly, model_power)\n\n# Расчет R?\nr2_linear &lt;- summary(model_linear)$r.squared\nr2_poly &lt;- summary(model_poly)$r.squared\nr2_power &lt;- 1 - sum(residuals(model_power)^2) / sum((data$weight - mean(data$weight))^2)\n\n# Создание таблицы сравнения моделей\ncomparison_table &lt;- data.frame(\n  Модель = c(\"Линейная\", \"Полиномиальная\", \"Степенная\"),\n  R_square = c(r2_linear, r2_poly, r2_power),\n  AIC = c(AIC(model_linear), AIC(model_poly), AIC(model_power))\n)\n\n# Вывод таблицы\nprint(comparison_table)\n\n# Остатки для степенной модели\ndata$residuals &lt;- residuals(model_power)\n\nggplot(data, aes(x = length, y = residuals)) +\n  geom_point(color = \"#FC4E07\", alpha = 0.7) +\n  geom_hline(yintercept = 0, linetype = \"dashed\") +\n  labs(title = \"Остатки степенной модели\", x = \"Длина (мм)\", y = \"Ошибка\")",
    "crumbs": [
      "<span class='chapter-number'>2</span>  <span class='chapter-title'>Анализ и визуализация данных улова</span>"
    ]
  },
  {
    "objectID": "chapter 1.html#выявление-аутлайеров-выбросов",
    "href": "chapter 1.html#выявление-аутлайеров-выбросов",
    "title": "2  Анализ и визуализация данных улова",
    "section": "2.4 Выявление аутлайеров (выбросов)",
    "text": "2.4 Выявление аутлайеров (выбросов)\nАутлаеры (выбросы) — наблюдения, значительно отклоняющиеся от общего распределения данных. Их идентификация критически важна, так как они могут искажать результаты анализа. Один из надёжных методов обнаружения выбросов — метод межквартильного размаха (IQR).\n\n2.4.1 Теория метода\n\nРасчёт квартилей:\n\nQ1 (25-й перцентиль): значение, ниже которого находится 25% данных.\nQ3 (75-й перцентиль): значение, ниже которого находится 75% данных.\nIQR = Q3 - Q1: мера разброса средней половины данных.\n\nГраницы аутлаеров:\n\nНижняя граница: Q1−1.5×IQRQ1−1.5×IQR\nВерхняя граница: Q3+1.5×IQRQ3+1.5×IQR\nНаблюдения за этими пределами считаются выбросами.\n\n\n\n\n2.4.2 Преимущества метода\n\nУстойчивость к асимметрии распределения.\nНе требует предположения о нормальности данных.\n\n\n# Метод межквартильного размаха\noutliers &lt;- data %&gt;%\n  mutate(\n    length_z = scale(length),\n    weight_z = scale(weight)\n  ) %&gt;% \n  filter(abs(length_z) &gt; 3 | abs(weight_z) &gt; 3)\n\n# Визуализация\nggplot(data, aes(x = length, y = weight)) +\n  geom_point(aes(color = \"Обычные\"), alpha = 0.5) +\n  geom_point(data = outliers, aes(color = \"Аутлаеры\"), size = 3) +\n  scale_color_manual(values = c(\"Обычные\" = \"grey50\", \"Аутлаеры\" = \"red\")) +\n  labs(title = \"Выявление аномальных наблюдений\", color = \"Тип\")\n\n\n\n\nРис. 1.3: Распределение длины карапакса",
    "crumbs": [
      "<span class='chapter-number'>2</span>  <span class='chapter-title'>Анализ и визуализация данных улова</span>"
    ]
  },
  {
    "objectID": "chapter 9.html",
    "href": "chapter 9.html",
    "title": "10  ПРП и стратегии управления",
    "section": "",
    "text": "10.1 Введение",
    "crumbs": [
      "<span class='chapter-number'>10</span>  <span class='chapter-title'>ПРП и стратегии управления</span>"
    ]
  },
  {
    "objectID": "chapter 9.html#загрузка-данных-и-первичный-осмотр",
    "href": "chapter 9.html#загрузка-данных-и-первичный-осмотр",
    "title": "10  ПРП и стратегии управления",
    "section": "10.2 Загрузка данных и первичный осмотр",
    "text": "10.2 Загрузка данных и первичный осмотр\nТекст. Текст. Текст.",
    "crumbs": [
      "<span class='chapter-number'>10</span>  <span class='chapter-title'>ПРП и стратегии управления</span>"
    ]
  },
  {
    "objectID": "chapter 9.html#описательная-статистика-и-визуализация",
    "href": "chapter 9.html#описательная-статистика-и-визуализация",
    "title": "10  ПРП и стратегии управления",
    "section": "10.3 Описательная статистика и визуализация",
    "text": "10.3 Описательная статистика и визуализация\nТекст. Текст. Текст.",
    "crumbs": [
      "<span class='chapter-number'>10</span>  <span class='chapter-title'>ПРП и стратегии управления</span>"
    ]
  },
  {
    "objectID": "chapter 4.html",
    "href": "chapter 4.html",
    "title": "5  SDM - Модели пространственного распределения видов",
    "section": "",
    "text": "5.1 Введение",
    "crumbs": [
      "<span class='chapter-number'>5</span>  <span class='chapter-title'>SDM - Модели пространственного распределения видов</span>"
    ]
  },
  {
    "objectID": "chapter 4.html#загрузка-данных-и-первичный-осмотр",
    "href": "chapter 4.html#загрузка-данных-и-первичный-осмотр",
    "title": "5  SDM - Модели пространственного распределения видов",
    "section": "5.2 Загрузка данных и первичный осмотр",
    "text": "5.2 Загрузка данных и первичный осмотр\nТекст. Текст. Текст.",
    "crumbs": [
      "<span class='chapter-number'>5</span>  <span class='chapter-title'>SDM - Модели пространственного распределения видов</span>"
    ]
  },
  {
    "objectID": "chapter 4.html#описательная-статистика-и-визуализация",
    "href": "chapter 4.html#описательная-статистика-и-визуализация",
    "title": "5  SDM - Модели пространственного распределения видов",
    "section": "5.3 Описательная статистика и визуализация",
    "text": "5.3 Описательная статистика и визуализация\nТекст. Текст. Текст.",
    "crumbs": [
      "<span class='chapter-number'>5</span>  <span class='chapter-title'>SDM - Модели пространственного распределения видов</span>"
    ]
  },
  {
    "objectID": "chapter 5.html",
    "href": "chapter 5.html",
    "title": "6  Основы геостатистики",
    "section": "",
    "text": "6.1 Введение",
    "crumbs": [
      "<span class='chapter-number'>6</span>  <span class='chapter-title'>Основы геостатистики</span>"
    ]
  },
  {
    "objectID": "chapter 5.html#загрузка-данных-и-первичный-осмотр",
    "href": "chapter 5.html#загрузка-данных-и-первичный-осмотр",
    "title": "6  Основы геостатистики",
    "section": "6.2 Загрузка данных и первичный осмотр",
    "text": "6.2 Загрузка данных и первичный осмотр\nТекст. Текст. Текст.",
    "crumbs": [
      "<span class='chapter-number'>6</span>  <span class='chapter-title'>Основы геостатистики</span>"
    ]
  },
  {
    "objectID": "chapter 5.html#описательная-статистика-и-визуализация",
    "href": "chapter 5.html#описательная-статистика-и-визуализация",
    "title": "6  Основы геостатистики",
    "section": "6.3 Описательная статистика и визуализация",
    "text": "6.3 Описательная статистика и визуализация\nТекст. Текст. Текст.",
    "crumbs": [
      "<span class='chapter-number'>6</span>  <span class='chapter-title'>Основы геостатистики</span>"
    ]
  },
  {
    "objectID": "chapter 6.html",
    "href": "chapter 6.html",
    "title": "7  Байесовский подход",
    "section": "",
    "text": "7.1 Лекция-Введение\n\\[  \nP(\\theta|x)=\\frac{L(x|\\theta)P(\\theta)}{\\sum\\limits_{i=1}^{n}{\\left[ L(x_i|\\theta)P(\\theta)\\right]}}  \n\\]",
    "crumbs": [
      "<span class='chapter-number'>7</span>  <span class='chapter-title'>Байесовский подход</span>"
    ]
  },
  {
    "objectID": "chapter 6.html#загрузка-данных-и-первичный-осмотр",
    "href": "chapter 6.html#загрузка-данных-и-первичный-осмотр",
    "title": "7  Байесовский подход",
    "section": "7.2 Загрузка данных и первичный осмотр",
    "text": "7.2 Загрузка данных и первичный осмотр\nТекст. Текст. Текст.",
    "crumbs": [
      "<span class='chapter-number'>7</span>  <span class='chapter-title'>Байесовский подход</span>"
    ]
  },
  {
    "objectID": "chapter 6.html#описательная-статистика-и-визуализация",
    "href": "chapter 6.html#описательная-статистика-и-визуализация",
    "title": "7  Байесовский подход",
    "section": "7.2 Описательная статистика и визуализация",
    "text": "7.2 Описательная статистика и визуализация\nТекст. Текст. Текст.",
    "crumbs": [
      "<span class='chapter-number'>7</span>  <span class='chapter-title'>Байесовский подход</span>"
    ]
  },
  {
    "objectID": "chapter 7.html",
    "href": "chapter 7.html",
    "title": "8  Продукционные модели",
    "section": "",
    "text": "8.1 Введение",
    "crumbs": [
      "<span class='chapter-number'>8</span>  <span class='chapter-title'>Продукционные модели</span>"
    ]
  },
  {
    "objectID": "chapter 7.html#загрузка-данных-и-первичный-осмотр",
    "href": "chapter 7.html#загрузка-данных-и-первичный-осмотр",
    "title": "8  Продукционные модели",
    "section": "8.2 Загрузка данных и первичный осмотр",
    "text": "8.2 Загрузка данных и первичный осмотр\nТекст. Текст. Текст.",
    "crumbs": [
      "<span class='chapter-number'>8</span>  <span class='chapter-title'>Продукционные модели</span>"
    ]
  },
  {
    "objectID": "chapter 7.html#описательная-статистика-и-визуализация",
    "href": "chapter 7.html#описательная-статистика-и-визуализация",
    "title": "8  Продукционные модели",
    "section": "8.3 Описательная статистика и визуализация",
    "text": "8.3 Описательная статистика и визуализация\nТекст. Текст. Текст.",
    "crumbs": [
      "<span class='chapter-number'>8</span>  <span class='chapter-title'>Продукционные модели</span>"
    ]
  },
  {
    "objectID": "chapter 8.html",
    "href": "chapter 8.html",
    "title": "9  Введение в прогнозирование",
    "section": "",
    "text": "9.1 Введение",
    "crumbs": [
      "<span class='chapter-number'>9</span>  <span class='chapter-title'>Введение в прогнозирование</span>"
    ]
  },
  {
    "objectID": "chapter 8.html#загрузка-данных-и-первичный-осмотр",
    "href": "chapter 8.html#загрузка-данных-и-первичный-осмотр",
    "title": "9  Введение в прогнозирование",
    "section": "9.2 Загрузка данных и первичный осмотр",
    "text": "9.2 Загрузка данных и первичный осмотр\nТекст. Текст. Текст.",
    "crumbs": [
      "<span class='chapter-number'>9</span>  <span class='chapter-title'>Введение в прогнозирование</span>"
    ]
  },
  {
    "objectID": "chapter 8.html#описательная-статистика-и-визуализация",
    "href": "chapter 8.html#описательная-статистика-и-визуализация",
    "title": "9  Введение в прогнозирование",
    "section": "9.3 Описательная статистика и визуализация",
    "text": "9.3 Описательная статистика и визуализация\nТекст. Текст. Текст.",
    "crumbs": [
      "<span class='chapter-number'>9</span>  <span class='chapter-title'>Введение в прогнозирование</span>"
    ]
  },
  {
    "objectID": "chapter 2.html#введение",
    "href": "chapter 2.html#введение",
    "title": "3  Нейронные сети в экологии: практическое введение",
    "section": "",
    "text": "3.1.0.1 Для работы скрипта:\n\nСкачайте файлы данных (vipkar.csv и kihzsdat.csv)\nУстановите рабочую директорию в setwd()\nУстановите необходимые пакеты : install.packages(c(\"neuralnet\", \"ggplot2\"))\n\n\n# ЗАГРУЗКА БИБЛИОТЕК И НАСТРОЙКА СРЕДЫ ================================\nlibrary(neuralnet)   # Для построения нейронных сетей\nlibrary(ggplot2)     # Для продвинутой визуализации (в данном скрипте не используется напрямую)\n\n# Установите свою рабочую директорию (где лежат файлы данных)\n# setwd(\"C:/ВАША_ДИРЕКТОРИЯ/\")",
    "crumbs": [
      "<span class='chapter-number'>3</span>  <span class='chapter-title'>Нейронные сети в экологии: практическое введение</span>"
    ]
  },
  {
    "objectID": "chapter 2.html#раздел-1-линейная-регрессия",
    "href": "chapter 2.html#раздел-1-линейная-регрессия",
    "title": "3  Нейронные сети в экологии: практическое введение",
    "section": "3.2 РАЗДЕЛ 1: ЛИНЕЙНАЯ РЕГРЕССИЯ",
    "text": "3.2 РАЗДЕЛ 1: ЛИНЕЙНАЯ РЕГРЕССИЯ\nВ этом разделе мы изучим основы экологического моделирования на примере зависимости массы тела гадюки от ее длины. Вы построите простую линейную регрессионную модель, визуализируете данные и линию регрессии, а также интерпретируете результаты с помощью функции summary().\nЗагружаем данные\n\n# Данные: масса (w) и длина тела (lt) гадюк (в см и граммах)\nw &lt;- c(85, 90, 85, 95, 95, 135, 165, 135, 140)\nlt &lt;- c(51, 51, 52, 54, 54, 59, 59, 60, 62)\n\nСтроим и запускаем модель \\[\nw_t = a_0 + a_1 \\cdot l_t\n\\]\nгде: - \\(w_t\\) — зависимая переменная, - \\(a_0\\) — свободный член, - \\(a_1\\) — коэффициент регрессии, - \\(l_t\\) — независимая переменная.\n\n# Построение линейной модели: w = a0 + a1*lt\nlreg &lt;- lm(w ~ lt)\n\nВыведем результаты модели\n\n# Просмотр результатов модели:\nsummary(lreg)  # Обратите внимание на коэффициенты и p-значения\n\nНа экране появится:\n\nCall:\nlm(formula = w ~ lt)\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-13.452  -7.585  -4.868   1.490  30.623 \n\nCoefficients:\n            Estimate Std. Error t value Pr(&gt;|t|)    \n(Intercept) -240.766     64.457  -3.735 0.007308 ** \nlt             6.358      1.153   5.516 0.000891 ***\n---\nSignif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1\n\nResidual standard error: 13.81 on 7 degrees of freedom\nMultiple R-squared:  0.813,     Adjusted R-squared:  0.7863 \nF-statistic: 30.43 on 1 and 7 DF,  p-value: 0.0008911\n\nМы получили результаты линейной регрессии, где зависимая переменная — масса тела гадюки (w), а независимая переменная — длина тела (lt). Разберем каждый параметр:\n1. **Call (Вызов модели):**\n`lm(formula = w ~ lt)`\nЭто просто напоминание, какая модель была построена. Здесь указано, что мы моделировали зависимость массы (w) от длины тела (lt) с помощью линейной регрессии.\n2. **Residuals (Остатки):**\nОстатки — это разница между наблюдаемыми значениями массы и предсказанными моделью значениями. Они показывают, насколько хорошо модель описывает данные.\n\n`Min`: минимальный остаток = -13.452 (наибольшее недооцененное значение)\n`1Q`: первый квартиль = -7.585 (25% остатков меньше этого значения)\n`Median`: медиана остатков = -4.868 (середина распределения остатков)\n`3Q`: третий квартиль = 1.490 (75% остатков меньше этого значения)\n`Max`: максимальный остаток = 30.623 (наибольшее переоцененное значение)\n\nРаспределение остатков: медиана немного смещена влево (отрицательное значение), а размах между 1Q и 3Q составляет примерно 9 единиц. Это может указывать на легкую асимметрию, но выборка мала.\n3. **Coefficients (Коэффициенты):**\n\n`(Intercept)`: свободный член (a0) = -240.766. Это предсказанное значение массы при длине тела, равной нулю. Биологически это не имеет смысла (длина не может быть нулевой), но это математическая особенность модели.\n`lt`: коэффициент регрессии (a1) = 6.358. Это означает, что при увеличении длины тела на 1 см масса тела увеличивается в среднем на 6.358 г.\n\nДля каждого коэффициента приведены:\n\n`Estimate`: точечная оценка коэффициента.\n`Std. Error`: стандартная ошибка оценки коэффициента. Для intercept = 64.457, для lt = 1.153. Это мера изменчивости оценки.\n`t value`: t-статистика. Рассчитывается как Estimate / Std.Error. Для intercept: -240.766 / 64.457 ≈ -3.735; для lt: 6.358 / 1.153 ≈ 5.516.\n`Pr(&gt;|t|)`: p-значение для проверки гипотезы о равенстве коэффициента нулю.\nДля intercept: p=0.007308 (значим на уровне α=0.01, т.е. intercept статистически значимо отличается от нуля).\nДля lt: p=0.000891 (значим на уровне α=0.001). Это означает, что длина тела значимо влияет на массу.\n\nЗначимость кодов: три звездочки (`***`) означают, что коэффициент значим на уровне 0.001.\n4. **Residual standard error (Стандартная ошибка остатков):** 13.81 на 7 степенях свободы. Это мера разброса остатков. В среднем, предсказания модели отклоняются от реальных значений на ±13.81 г. Степени свободы (df) = n - 2 = 9 - 2 = 7 (n — количество наблюдений).\n5. **Multiple R-squared (Коэффициент детерминации R²):** 0.813. Это означает, что 81.3% вариации массы тела объясняется длиной тела. Остальные 18.7% — это неучтенные факторы и случайная изменчивость.\n6. **Adjusted R-squared (Скорректированный R²):** 0.7863. Этот показатель корректирует R² с учетом числа предикторов. Он полезен при сравнении моделей с разным числом предикторов. Здесь он немного меньше R², так как учитывает, что в модели один предиктор.\n7. **F-statistic (F-статистика):** 30.43 на 1 и 7 степенях свободы. Проверяет гипотезу о том, что все коэффициенты (кроме intercept) равны нулю (т.е. модель не лучше, чем модель только с константой).\n\np-value: 0.0008911 (крайне значимый), что означает, что модель в целом адекватна.\n\n**Выводы:**\n- Уравнение модели: `w = -240.77 + 6.36 * lt`\n- Длина тела значимо влияет на массу (p&lt;0.001).\n- Модель объясняет 81.3% вариации массы.\n- На каждый сантиметр длины тела масса увеличивается примерно на 6.36 г.\n- Остатки модели показывают, что есть несколько точек, которые модель предсказывает с заметной ошибкой (особенно максимальный остаток в 30.6 г). Возможно, для более точного прогноза нужна нелинейная модель или учет дополнительных факторов.\n**Рекомендации:**\n- Проверить допущения линейной регрессии (нормальность остатков, гомоскедастичность) с помощью диагностических графиков.\n- Рассмотреть возможность включения других переменных (например, возраста, пола) в модель.\n- Убедиться, что в данных нет выбросов, которые могут влиять на коэффициенты.\n\n# Визуализация зависимости\nplot(lt, w, \n     main = \"Зависимость массы от длины тела гадюки\", \n     xlab = \"Длина тела (см)\", \n     ylab = \"Масса (г)\", \n     pch = 19,        # Кружки вместо стандартных точек\n     col = \"darkgreen\")\nabline(lreg, col = \"red\", lwd = 2)  # Добавляем линию регрессии\n\n\n\n\nРис. 1.: Пример линейной регрессии",
    "crumbs": [
      "<span class='chapter-number'>3</span>  <span class='chapter-title'>Нейронные сети в экологии: практическое введение</span>"
    ]
  },
  {
    "objectID": "chapter 2.html#раздел-2-численная-оптимизация",
    "href": "chapter 2.html#раздел-2-численная-оптимизация",
    "title": "3  Нейронные сети в экологии: практическое введение",
    "section": "3.3 РАЗДЕЛ 2: ЧИСЛЕННАЯ ОПТИМИЗАЦИЯ",
    "text": "3.3 РАЗДЕЛ 2: ЧИСЛЕННАЯ ОПТИМИЗАЦИЯ\nЗдесь вы познакомитесь с численными методами оптимизации параметров моделей, которые применяются, когда аналитическое решение невозможно. На примере той же зависимости массы от длины вы подгоните параметры модели с помощью функции nls() и сравните результаты с аналитическим решением.\nАналитические методы дают точное решение в виде математической формулы, используя алгебраические преобразования и теоремы математического анализа. Они идеальны для простых моделей, где существуют явные решения, обеспечивая прозрачную интерпретацию параметров. В экологии такие методы применимы для базовых зависимостей типа линейной регрессии. Численные методы используются, когда аналитическое решение невозможно, и работают через последовательные приближения, начиная со стартовых значений и итеративно улучшая параметры модели. Они незаменимы для сложных экологических моделей с нелинейными зависимостями, взаимодействиями факторов и “шумными” полевыми данными, позволяя решать задачи, недоступные для аналитических подходов.\n\n# Подгонка параметров через оптимизацию\nnls_model &lt;- nls(w ~ a0 + a1 * lt, start = list(a0 = 1, a1 = 1))\nsummary(nls_model)\n\nНа экране появится:\n\nFormula: w ~ a0 + a1 * lt\n\nParameters:\n   Estimate Std. Error t value Pr(&gt;|t|)    \na0 -240.766     64.457  -3.735 0.007308 ** \na1    6.358      1.153   5.516 0.000891 ***\n---\nSignif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1\n\nResidual standard error: 13.81 on 7 degrees of freedom\n\nNumber of iterations to convergence: 1 \nAchieved convergence tolerance: 3.247e-08\n\n\n3.3.1 Интерпретация результатов модели\nМы построили линейную модель зависимости массы гадюки (w) от длины её тела (lt) по формуле:\nw = a0 + a1 * lt\nКлючевые параметры модели:\n\na0 (свободный член): -240.8 г\nЭто теоретическая масса при нулевой длине тела. Отрицательное значение указывает, что модель не подходит для очень молодых особей.\na1 (коэффициент при lt): 6.36 г/см\nКаждый дополнительный сантиметр длины тела увеличивает массу в среднем на 6.36 г.\n\nТочность и значимость:\n\nОба коэффициента высоко значимы (p &lt; 0.01), что подтверждает реальность зависимости.\nСтандартная ошибка для a1 составляет 1.15 г/см - это значит, что реальное значение, вероятно, находится между 5.2 и 7.5 г/см.\nМодель хорошо сошлась за 1 шаг (итерацию), что говорит об удачном подборе параметров.\n\nОшибка прогноза:\nСреднее отклонение предсказаний от реальных значений - 13.8 г (стандартная ошибка остатков). Для особи массой 100 г это означает возможную ошибку прогноза около 14%.\n\nБиологический смысл: Модель подтверждает сильную аллометрию - крупные гадюки имеют относительно большую массу тела. Каждый сантиметр длины добавляет около 6.4 г массы. Для особи длиной 55 см прогнозируемая масса составит: -240.8 + 6.36*55 ≈ 109 г.",
    "crumbs": [
      "<span class='chapter-number'>3</span>  <span class='chapter-title'>Нейронные сети в экологии: практическое введение</span>"
    ]
  },
  {
    "objectID": "chapter 2.html#раздел-3-множественная-регрессия",
    "href": "chapter 2.html#раздел-3-множественная-регрессия",
    "title": "3  Нейронные сети в экологии: практическое введение",
    "section": "3.4 РАЗДЕЛ 3: МНОЖЕСТВЕННАЯ РЕГРЕССИЯ",
    "text": "3.4 РАЗДЕЛ 3: МНОЖЕСТВЕННАЯ РЕГРЕССИЯ\nВ этом разделе мы расширим модель, включив несколько факторов. Вы построите множественную регрессию, учитывающую одновременно длину тела и длину хвоста гадюки, и научитесь интерпретировать влияние нескольких предикторов на зависимую переменную.\n\n# Добавляем новый признак - длину хвоста (lc)\nw &lt;- c(40, 156, 105, 85, 80, 50, 75, 48, 75, 67)\nlt &lt;- c(44, 59, 49, 50, 54, 43, 49, 42, 47, 47)\nlc &lt;- c(70, 78, 66, 90, 83, 70, 62, 75, 40, 80)\n\nИспользуя glm-функцию, построим модель с двумя предикторами: \\[\nw = a_0 + a_1 \\cdot l_t + a_2 \\cdot l_c\n\\]\nгде: - \\(w\\) — масса гадюки, - \\(l_t\\) — длина тела гадюки, - \\(l_c\\) — длина хвоста гадюки, - \\(a_0\\) — свободный член (константа), - \\(a_1\\) — коэффициент регрессии при длине тела, - \\(a_2\\) — коэффициент регрессии при длине хвоста.\n\n# Множественная регрессия: w = a0 + a1*lt + a2*lc\nmulti_reg &lt;- glm(w ~ lt + lc)\nsummary(multi_reg)\n\nНа экране появится:\n\nCall:\nglm(formula = w ~ lt + lc)\n\nCoefficients:\n             Estimate Std. Error t value Pr(&gt;|t|)    \n(Intercept) -191.2982    53.6908  -3.563 0.009183 ** \nlt             6.0308     1.1051   5.457 0.000949 ***\nlc            -0.3150     0.4133  -0.762 0.470913    \n---\nSignif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1\n\n(Dispersion parameter for gaussian family taken to be 270.9752)\n\n    Null deviance: 10132.9  on 9  degrees of freedom\nResidual deviance:  1896.8  on 7  degrees of freedom\nAIC: 88.832\n\nNumber of Fisher Scoring iterations: 2\n\n\n3.4.1 Интерпретация результатов множественной регрессии\nМы исследовали зависимость массы гадюки (w) от длины тела (lt) и длины хвоста (lc) с помощью модели:\nw = b0 + b1*lt + b2*lc\nКлючевые выводы модели:\n\nДлина тела (lt) сильно влияет на массу:\n\nКоэффициент: +6.03 г/см\nКаждый сантиметр длины тела увеличивает массу на ~6 г\nВысокая значимость (p = 0.00095)\n\nДлина хвоста (lc) не влияет значимо на массу:\n\nКоэффициент: -0.315 г/см (незначимый)\np-значение 0.47 &gt; 0.05 - статистически недостоверно\nПосле учета длины тела, длина хвоста не добавляет информации\n\nСвободный член (b0): -191.3 г\nОтрицательное значение подтверждает нелинейность роста у молодых особей\n\nКачество модели:\n\nМодель объясняет значительную часть вариации:\nОбщая вариация (Null deviance) = 10132.9\nОстаточная вариация (Residual deviance) = 1896.8 → Объяснено 81% вариации\nAIC = 88.8 (ниже, чем у модели без lc - 92.1, что указывает на лучшее качество)\nМодель быстро сошлась за 2 итерации\n\nБиологическая интерпретация:\n\nМасса тела определяется в основном длиной туловища, а не хвоста\nДля прогноза массы достаточно учитывать только длину тела\nПример прогноза для особи (lt=50 см, lc=70 см):\n-191.3 + 6.03*50 - 0.315*70 ≈ 111 г\n\n\nРекомендация: При изучении массы гадюк можно исключить длину хвоста из модели, так как она не вносит значимого вклада в предсказание. Основным морфометрическим показателем остается длина тела.",
    "crumbs": [
      "<span class='chapter-number'>3</span>  <span class='chapter-title'>Нейронные сети в экологии: практическое введение</span>"
    ]
  },
  {
    "objectID": "chapter 2.html#раздел-4-нелинейные-зависимости",
    "href": "chapter 2.html#раздел-4-нелинейные-зависимости",
    "title": "3  Нейронные сети в экологии: практическое введение",
    "section": "3.5 РАЗДЕЛ 4: НЕЛИНЕЙНЫЕ ЗАВИСИМОСТИ",
    "text": "3.5 РАЗДЕЛ 4: НЕЛИНЕЙНЫЕ ЗАВИСИМОСТИ\nЭкологические данные часто имеют нелинейный характер. Здесь вы смоделируете степенную зависимость (аллометрию) между массой и длиной тела, используя линеаризацию через логарифмирование, а затем визуализируете кривую модели.\n\n# Часто в экологии связи имеют степенной характер: w = a0 * lt^a1\n# Линеаризация через логарифмирование\nlog_model &lt;- lm(log(w) ~ log(lt))\n\n# Преобразование коэффициентов обратно\na0 &lt;- exp(coef(log_model)[1])  # Переход от логарифмов\na1 &lt;- coef(log_model)[2]       # Показатель степени\n\n# Визуализация степенной зависимости\nplot(lt, w, \n     main = \"Степенная зависимость массы от длины\", \n     xlab = \"Длина тела (см)\", \n     ylab = \"Масса (г)\",\n     pch = 17,\n     col = \"blue\")\ncurve(a0 * x^a1, add = TRUE, col = \"red\", lwd = 2)  # Кривая модели\n\n\n\n\nРис. 2.: Расчет степенной функции",
    "crumbs": [
      "<span class='chapter-number'>3</span>  <span class='chapter-title'>Нейронные сети в экологии: практическое введение</span>"
    ]
  },
  {
    "objectID": "chapter 2.html#раздел-5-логистическая-регрессия",
    "href": "chapter 2.html#раздел-5-логистическая-регрессия",
    "title": "3  Нейронные сети в экологии: практическое введение",
    "section": "3.6 РАЗДЕЛ 5: ЛОГИСТИЧЕСКАЯ РЕГРЕССИЯ",
    "text": "3.6 РАЗДЕЛ 5: ЛОГИСТИЧЕСКАЯ РЕГРЕССИЯ\nВы изучите моделирование пороговых эффектов в экологии на примере смертности дафний в зависимости от концентрации токсиканта. Построив логистическую регрессию, вы получите S-образную кривую, характерную для таких процессов.\n\n# Пример: смертность дафний при разных концентрациях токсиканта\n# Данные:\nK &lt;- c(100, 126, 158, 200, 251, 316, 398, 501, 631, 794, 1000)\np &lt;- c(0, 0, 0, 0, 0, 0.5, 0.5, 1, 1, 1, 1)  # Доля погибших\nd &lt;- data.frame(K, p)\n\n# Построение логистической модели\nlogit_model &lt;- glm(p ~ K, family = binomial(), data = d)\n\n# Визуализация S-образной кривой\nplot(d$K, d$p, \n     xlab = \"Концентрация токсиканта (мг/л)\", \n     ylab = \"Доля погибших\", \n     main = \"Токсическое воздействие на дафний\",\n     pch = 19,\n     col = \"red\")\nlines(d$K, predict(logit_model, type = \"response\"), \n      col = \"blue\", lwd = 2, lty = 1)\n\n\n\n\nРис. 3.: Расчет логистической регрессии гибели дафний в токсиканте",
    "crumbs": [
      "<span class='chapter-number'>3</span>  <span class='chapter-title'>Нейронные сети в экологии: практическое введение</span>"
    ]
  },
  {
    "objectID": "chapter 2.html#раздел-6-перехнейронным-сетям",
    "href": "chapter 2.html#раздел-6-перехнейронным-сетям",
    "title": "3  Нейронные сети в экологии: практическое введение",
    "section": "3.7 РАЗДЕЛ 6: ПЕРЕХНЕЙРОННЫМ СЕТЯМ",
    "text": "3.7 РАЗДЕЛ 6: ПЕРЕХНЕЙРОННЫМ СЕТЯМ\nВ этом разделе вы сделаете первый шаг к нейронным сетям, построив простейшую сеть без скрытых слоев (аналог линейной регрессии) для модели токсичности. Вы визуализируете структуру сети и убедитесь, что она дает результат, аналогичный линейной модели.",
    "crumbs": [
      "<span class='chapter-number'>3</span>  <span class='chapter-title'>Нейронные сети в экологии: практическое введение</span>"
    ]
  },
  {
    "objectID": "chapter 2.html#раздел-7-нейроны-как-нелинейные-преобразователи",
    "href": "chapter 2.html#раздел-7-нейроны-как-нелинейные-преобразователи",
    "title": "3  Нейронные сети в экологии: практическое введение",
    "section": "3.8 РАЗДЕЛ 7: НЕЙРОНЫ КАК НЕЛИНЕЙНЫЕ ПРЕОБРАЗОВАТЕЛИ",
    "text": "3.8 РАЗДЕЛ 7: НЕЙРОНЫ КАК НЕЛИНЕЙНЫЕ ПРЕОБРАЗОВАТЕЛИ\nЗдесь вы добавите в нейронную сеть скрытый слой с одним нейроном, что позволит моделировать нелинейные зависимости. Вы сравните результат работы такой сети с логистической регрессией и увидите, как нейронная сеть имитирует пороговый эффект.\n\n# Сеть с одним скрытым нейроном (имитирует логистическую регрессию)\nnn_1hidden &lt;- neuralnet(p ~ K, data = d, hidden = 1)\n\n# Сравнение с логистической регрессией\nplot(d$K, predict(logit_model, type = \"response\"), \n     type = \"l\", \n     col = \"darkgreen\", \n     lwd = 2,\n     xlab = \"Концентрация\", \n     ylab = \"Смертность\",\n     main = \"Сравнение моделей\")\nlines(d$K, predict(nn_1hidden, d), col = \"blue\", lty = 2, lwd = 2)\nlegend(\"bottomright\", \n       legend = c(\"Логистическая регрессия\", \"Нейронная сеть (1 нейрон)\"),\n       col = c(\"darkgreen\", \"blue\"), \n       lty = 1:2,\n       lwd = 2)\n\n\n\n\nРис. 5.: Сравнение работы",
    "crumbs": [
      "<span class='chapter-number'>3</span>  <span class='chapter-title'>Нейронные сети в экологии: практическое введение</span>"
    ]
  },
  {
    "objectID": "chapter 2.html#раздел-8-классификация-в-экологии",
    "href": "chapter 2.html#раздел-8-классификация-в-экологии",
    "title": "3  Нейронные сети в экологии: практическое введение",
    "section": "3.9 РАЗДЕЛ 8: КЛАССИФИКАЦИЯ В ЭКОЛОГИИ",
    "text": "3.9 РАЗДЕЛ 8: КЛАССИФИКАЦИЯ В ЭКОЛОГИИ\nВы примените нейронные сети для решения задачи классификации - определения пола гадюк по морфометрическим признакам. Построив и сравнив несколько архитектур сетей (без скрытых нейронов, с одним и тремя нейронами), вы оцените их точность.\n\n# Загрузка данных по гадюкам (пол, длина тела, длина хвоста, масса)\nv &lt;- read.csv(\"vipkar.csv\")\nhead(v, 3)  # Просмотр первых строк данных\n\nМодель без скрытых нейронов (аналог линейной регрессии)\n\nnv0 &lt;- neuralnet(ns ~ lc, data = v, hidden = 0)\nplot(nv0)  # Визуализация простейшей сети\n\n\n\n\nРис. 6.: Визуализация простейшей сети\n\n\nМодель с одним скрытым нейроном\n\nnv1 &lt;- neuralnet(ns ~ lc, data = v, hidden = 1)\nplot(nv1)  # Схема сети с одним нейроном\n\n\n\n\nРис. 7.: Схема сети с одним нейроном\n\n\nМодель с тремя скрытыми нейронами (полноценная нейросеть)\n\nnv3 &lt;- neuralnet(ns ~ lc + lt + w, data = v, hidden = 3)\nplot(nv3)  # Визуализация сложной сети\n\n\n\n\nРис. 8.: Модель с тремя скрытыми нейронами\n\n\nОценка точности классификации\n\npredictions &lt;- predict(nv3, v)\npredicted_sex &lt;- round(predictions)\naccuracy &lt;- mean(v$ns == predicted_sex)\ncat(\"Точность классификации:\", round(accuracy*100, 1), \"%\\n\")\n\nТочность классификации: 100 %",
    "crumbs": [
      "<span class='chapter-number'>3</span>  <span class='chapter-title'>Нейронные сети в экологии: практическое введение</span>"
    ]
  },
  {
    "objectID": "chapter 2.html#раздел-9-пространственное-моделирование",
    "href": "chapter 2.html#раздел-9-пространственное-моделирование",
    "title": "3  Нейронные сети в экологии: практическое введение",
    "section": "3.10 РАЗДЕЛ 9: ПРОСТРАНСТВЕННОЕ МОДЕЛИРОВАНИЕ",
    "text": "3.10 РАЗДЕЛ 9: ПРОСТРАНСТВЕННОЕ МОДЕЛИРОВАНИЕ\nВ завершение вы построите нейронную сеть для прогнозирования численности гадюк на островах по характеристикам биотопов. Вы разделите данные на обучающую и тестовую выборки, оцените точность модели и используете ее для прогноза в новых условиях.\n\n# Данные по островам Кижского архипелага\nv &lt;- read.csv(\"kihzsdat.csv\")\nhead(v, 3)  # Структура данных: площадь, биотопы, численность видов\n\n# Случайное разделение данных на обучающую и тестовую выборки\nset.seed(123)  # Для воспроизводимости\ntrain_indices &lt;- sample(1:nrow(v), 12)\ntrain_data &lt;- v[train_indices, ]\ntest_data &lt;- v[-train_indices, ]\n\n# Построение нейросети с 5 нейронами в скрытом слое\nmodel &lt;- neuralnet(vb ~ fo + me + bo, data = train_data, hidden = 5)\n\n# Прогнозирование на обучающей выборке\ntrain_pred &lt;- predict(model, train_data)\ntrain_accuracy &lt;- mean(round(train_pred) == train_data$vb)\ncat(\"Точность на обучающей выборке:\", round(train_accuracy*100, 1), \"%\\n\")\n\n# Прогнозирование на тестовой выборке\ntest_pred &lt;- predict(model, test_data)\ntest_accuracy &lt;- mean(round(test_pred) == test_data$vb)\ncat(\"Точность на тестовой выборке:\", round(test_accuracy*100, 1), \"%\\n\")\n\n# Прогноз для новых условий (пример)\nnew_conditions &lt;- data.frame(\n  fo = c(57.9, 35.3, 83.0),  # Площадь лесов (%)\n  me = c(4.1, 0.0, 7.3),     # Площадь лугов (%)\n  bo = c(3.4, 7.9, 11.5)     # Площадь болот (%)\n)\n\nfuture_pred &lt;- predict(model, new_conditions)\ncat(\"Прогнозируемая численность гадюк:\", round(future_pred), \"\\n\")",
    "crumbs": [
      "<span class='chapter-number'>3</span>  <span class='chapter-title'>Нейронные сети в экологии: практическое введение</span>"
    ]
  },
  {
    "objectID": "chapter 2.html#раздел-6-перех-нейронным-сетям",
    "href": "chapter 2.html#раздел-6-перех-нейронным-сетям",
    "title": "3  Нейронные сети в экологии: практическое введение",
    "section": "3.7 РАЗДЕЛ 6: ПЕРЕХ НЕЙРОННЫМ СЕТЯМ",
    "text": "3.7 РАЗДЕЛ 6: ПЕРЕХ НЕЙРОННЫМ СЕТЯМ\nВ этом разделе вы сделаете первый шаг к нейронным сетям, построив простейшую сеть без скрытых слоев (аналог линейной регрессии) для модели токсичности. Вы визуализируете структуру сети и убедитесь, что она дает результат, аналогичный линейной модели.",
    "crumbs": [
      "<span class='chapter-number'>3</span>  <span class='chapter-title'>Нейронные сети в экологии: практическое введение</span>"
    ]
  },
  {
    "objectID": "chapter 2.html#раздел-6-переход-к-сетям",
    "href": "chapter 2.html#раздел-6-переход-к-сетям",
    "title": "3  Нейронные сети в экологии: практическое введение",
    "section": "3.7 РАЗДЕЛ 6: ПЕРЕХОД К СЕТЯМ",
    "text": "3.7 РАЗДЕЛ 6: ПЕРЕХОД К СЕТЯМ\nСделаем первый шаг к нейронным сетям, построив простейшую сеть без скрытых слоев (аналог линейной регрессии) для модели токсичности. Вы визуализируете структуру сети и убедитесь, что она дает результат, аналогичный линейной модели.\n\n# Простейшая нейросеть (аналог линейной регрессии)\nnn_simple &lt;- neuralnet(p ~ K, data = d, hidden = 0)\n\n# Визуализация структуры сети\nplot(nn_simple, rep = \"best\")\n\n\n\n\nРис. 4.: Схема нейрона",
    "crumbs": [
      "<span class='chapter-number'>3</span>  <span class='chapter-title'>Нейронные сети в экологии: практическое введение</span>"
    ]
  },
  {
    "objectID": "chapter 2.html#линейная-регрессия",
    "href": "chapter 2.html#линейная-регрессия",
    "title": "3  Нейронные сети в экологии: практическое введение",
    "section": "3.2 ЛИНЕЙНАЯ РЕГРЕССИЯ",
    "text": "3.2 ЛИНЕЙНАЯ РЕГРЕССИЯ\nВ этом разделе мы изучим основы экологического моделирования на примере зависимости массы тела гадюки от ее длины. Вы построите простую линейную регрессионную модель, визуализируете данные и линию регрессии, а также интерпретируете результаты с помощью функции summary().\nЗагружаем данные\n\n# Данные: масса (w) и длина тела (lt) гадюк (в см и граммах)\nw &lt;- c(85, 90, 85, 95, 95, 135, 165, 135, 140)\nlt &lt;- c(51, 51, 52, 54, 54, 59, 59, 60, 62)\n\nСтроим и запускаем модель \\[\nw_t = a_0 + a_1 \\cdot l_t\n\\]\nгде: - \\(w_t\\) — зависимая переменная, - \\(a_0\\) — свободный член, - \\(a_1\\) — коэффициент регрессии, - \\(l_t\\) — независимая переменная.\n\n# Построение линейной модели: w = a0 + a1*lt\nlreg &lt;- lm(w ~ lt)\n\nВыведем результаты модели\n\n# Просмотр результатов модели:\nsummary(lreg)  # Обратите внимание на коэффициенты и p-значения\n\nНа экране появится:\n\nCall:\nlm(formula = w ~ lt)\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-13.452  -7.585  -4.868   1.490  30.623 \n\nCoefficients:\n            Estimate Std. Error t value Pr(&gt;|t|)    \n(Intercept) -240.766     64.457  -3.735 0.007308 ** \nlt             6.358      1.153   5.516 0.000891 ***\n---\nSignif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1\n\nResidual standard error: 13.81 on 7 degrees of freedom\nMultiple R-squared:  0.813,     Adjusted R-squared:  0.7863 \nF-statistic: 30.43 on 1 and 7 DF,  p-value: 0.0008911\n\nМы получили результаты линейной регрессии, где зависимая переменная — масса тела гадюки (w), а независимая переменная — длина тела (lt). Разберем каждый параметр:\n1. **Call (Вызов модели):**\n`lm(formula = w ~ lt)`\nЭто просто напоминание, какая модель была построена. Здесь указано, что мы моделировали зависимость массы (w) от длины тела (lt) с помощью линейной регрессии.\n2. **Residuals (Остатки):**\nОстатки — это разница между наблюдаемыми значениями массы и предсказанными моделью значениями. Они показывают, насколько хорошо модель описывает данные.\n\n`Min`: минимальный остаток = -13.452 (наибольшее недооцененное значение)\n`1Q`: первый квартиль = -7.585 (25% остатков меньше этого значения)\n`Median`: медиана остатков = -4.868 (середина распределения остатков)\n`3Q`: третий квартиль = 1.490 (75% остатков меньше этого значения)\n`Max`: максимальный остаток = 30.623 (наибольшее переоцененное значение)\n\nРаспределение остатков: медиана немного смещена влево (отрицательное значение), а размах между 1Q и 3Q составляет примерно 9 единиц. Это может указывать на легкую асимметрию, но выборка мала.\n3. **Coefficients (Коэффициенты):**\n\n`(Intercept)`: свободный член (a0) = -240.766. Это предсказанное значение массы при длине тела, равной нулю. Биологически это не имеет смысла (длина не может быть нулевой), но это математическая особенность модели.\n`lt`: коэффициент регрессии (a1) = 6.358. Это означает, что при увеличении длины тела на 1 см масса тела увеличивается в среднем на 6.358 г.\n\nДля каждого коэффициента приведены:\n\n`Estimate`: точечная оценка коэффициента.\n`Std. Error`: стандартная ошибка оценки коэффициента. Для intercept = 64.457, для lt = 1.153. Это мера изменчивости оценки.\n`t value`: t-статистика. Рассчитывается как Estimate / Std.Error. Для intercept: -240.766 / 64.457 ≈ -3.735; для lt: 6.358 / 1.153 ≈ 5.516.\n`Pr(&gt;|t|)`: p-значение для проверки гипотезы о равенстве коэффициента нулю.\nДля intercept: p=0.007308 (значим на уровне α=0.01, т.е. intercept статистически значимо отличается от нуля).\nДля lt: p=0.000891 (значим на уровне α=0.001). Это означает, что длина тела значимо влияет на массу.\n\nЗначимость кодов: три звездочки (`***`) означают, что коэффициент значим на уровне 0.001.\n4. **Residual standard error (Стандартная ошибка остатков):** 13.81 на 7 степенях свободы. Это мера разброса остатков. В среднем, предсказания модели отклоняются от реальных значений на ±13.81 г. Степени свободы (df) = n - 2 = 9 - 2 = 7 (n — количество наблюдений).\n5. **Multiple R-squared (Коэффициент детерминации R²):** 0.813. Это означает, что 81.3% вариации массы тела объясняется длиной тела. Остальные 18.7% — это неучтенные факторы и случайная изменчивость.\n6. **Adjusted R-squared (Скорректированный R²):** 0.7863. Этот показатель корректирует R² с учетом числа предикторов. Он полезен при сравнении моделей с разным числом предикторов. Здесь он немного меньше R², так как учитывает, что в модели один предиктор.\n7. **F-statistic (F-статистика):** 30.43 на 1 и 7 степенях свободы. Проверяет гипотезу о том, что все коэффициенты (кроме intercept) равны нулю (т.е. модель не лучше, чем модель только с константой).\n\np-value: 0.0008911 (крайне значимый), что означает, что модель в целом адекватна.\n\n**Выводы:**\n- Уравнение модели: `w = -240.77 + 6.36 * lt`\n- Длина тела значимо влияет на массу (p&lt;0.001).\n- Модель объясняет 81.3% вариации массы.\n- На каждый сантиметр длины тела масса увеличивается примерно на 6.36 г.\n- Остатки модели показывают, что есть несколько точек, которые модель предсказывает с заметной ошибкой (особенно максимальный остаток в 30.6 г). Возможно, для более точного прогноза нужна нелинейная модель или учет дополнительных факторов.\n**Рекомендации:**\n- Проверить допущения линейной регрессии (нормальность остатков, гомоскедастичность) с помощью диагностических графиков.\n- Рассмотреть возможность включения других переменных (например, возраста, пола) в модель.\n- Убедиться, что в данных нет выбросов, которые могут влиять на коэффициенты.\n\n# Визуализация зависимости\nplot(lt, w, \n     main = \"Зависимость массы от длины тела гадюки\", \n     xlab = \"Длина тела (см)\", \n     ylab = \"Масса (г)\", \n     pch = 19,        # Кружки вместо стандартных точек\n     col = \"darkgreen\")\nabline(lreg, col = \"red\", lwd = 2)  # Добавляем линию регрессии\n\n\n\n\nРис. 1.: Пример линейной регрессии",
    "crumbs": [
      "<span class='chapter-number'>3</span>  <span class='chapter-title'>Нейронные сети в экологии: практическое введение</span>"
    ]
  },
  {
    "objectID": "chapter 2.html#нелинейные-зависимости",
    "href": "chapter 2.html#нелинейные-зависимости",
    "title": "3  Нейронные сети в экологии: практическое введение",
    "section": "3.4 НЕЛИНЕЙНЫЕ ЗАВИСИМОСТИ",
    "text": "3.4 НЕЛИНЕЙНЫЕ ЗАВИСИМОСТИ\nЭкологические данные часто имеют нелинейный характер. Здесь вы смоделируете степенную зависимость (аллометрию) между массой и длиной тела, используя линеаризацию через логарифмирование, а затем визуализируете кривую модели.\n\n# Часто в экологии связи имеют степенной характер: w = a0 * lt^a1\n# Линеаризация через логарифмирование\nlog_model &lt;- lm(log(w) ~ log(lt))\n\n# Преобразование коэффициентов обратно\na0 &lt;- exp(coef(log_model)[1])  # Переход от логарифмов\na1 &lt;- coef(log_model)[2]       # Показатель степени\n\n# Визуализация степенной зависимости\nplot(lt, w, \n     main = \"Степенная зависимость массы от длины\", \n     xlab = \"Длина тела (см)\", \n     ylab = \"Масса (г)\",\n     pch = 17,\n     col = \"blue\")\ncurve(a0 * x^a1, add = TRUE, col = \"red\", lwd = 2)  # Кривая модели\n\n\n\n\nРис. 2.: Расчет степенной функции",
    "crumbs": [
      "<span class='chapter-number'>3</span>  <span class='chapter-title'>Нейронные сети в экологии: практическое введение</span>"
    ]
  },
  {
    "objectID": "chapter 2.html#логистическая-регрессия",
    "href": "chapter 2.html#логистическая-регрессия",
    "title": "3  Нейронные сети в экологии: практическое введение",
    "section": "3.5 ЛОГИСТИЧЕСКАЯ РЕГРЕССИЯ",
    "text": "3.5 ЛОГИСТИЧЕСКАЯ РЕГРЕССИЯ\nВы изучите моделирование пороговых эффектов в экологии на примере смертности дафний в зависимости от концентрации токсиканта. Построив логистическую регрессию, вы получите S-образную кривую, характерную для таких процессов.\n\n# Пример: смертность дафний при разных концентрациях токсиканта\n# Данные:\nK &lt;- c(100, 126, 158, 200, 251, 316, 398, 501, 631, 794, 1000)\np &lt;- c(0, 0, 0, 0, 0, 0.5, 0.5, 1, 1, 1, 1)  # Доля погибших\nd &lt;- data.frame(K, p)\n\n# Построение логистической модели\nlogit_model &lt;- glm(p ~ K, family = binomial(), data = d)\n\n# Визуализация S-образной кривой\nplot(d$K, d$p, \n     xlab = \"Концентрация токсиканта (мг/л)\", \n     ylab = \"Доля погибших\", \n     main = \"Токсическое воздействие на дафний\",\n     pch = 19,\n     col = \"red\")\nlines(d$K, predict(logit_model, type = \"response\"), \n      col = \"blue\", lwd = 2, lty = 1)\n\n\n\n\nРис. 3.: Расчет логистической регрессии гибели дафний в токсиканте",
    "crumbs": [
      "<span class='chapter-number'>3</span>  <span class='chapter-title'>Нейронные сети в экологии: практическое введение</span>"
    ]
  },
  {
    "objectID": "chapter 2.html#переход-к-сетям",
    "href": "chapter 2.html#переход-к-сетям",
    "title": "3  Нейронные сети в экологии: практическое введение",
    "section": "3.6 ПЕРЕХОД К СЕТЯМ",
    "text": "3.6 ПЕРЕХОД К СЕТЯМ\nСделаем первый шаг к нейронным сетям, построив простейшую сеть без скрытых слоев (аналог линейной регрессии) для модели токсичности. Вы визуализируете структуру сети и убедитесь, что она дает результат, аналогичный линейной модели.\n\n# Простейшая нейросеть (аналог линейной регрессии)\nnn_simple &lt;- neuralnet(p ~ K, data = d, hidden = 0)\n\n# Визуализация структуры сети\nplot(nn_simple, rep = \"best\")\n\n\n\n\nРис. 4.: Схема нейрона",
    "crumbs": [
      "<span class='chapter-number'>3</span>  <span class='chapter-title'>Нейронные сети в экологии: практическое введение</span>"
    ]
  },
  {
    "objectID": "chapter 2.html#нейроны-как-нелинейные-преобразователи",
    "href": "chapter 2.html#нейроны-как-нелинейные-преобразователи",
    "title": "3  Нейронные сети в экологии: практическое введение",
    "section": "3.7 НЕЙРОНЫ КАК НЕЛИНЕЙНЫЕ ПРЕОБРАЗОВАТЕЛИ",
    "text": "3.7 НЕЙРОНЫ КАК НЕЛИНЕЙНЫЕ ПРЕОБРАЗОВАТЕЛИ\nЗдесь вы добавите в нейронную сеть скрытый слой с одним нейроном, что позволит моделировать нелинейные зависимости. Вы сравните результат работы такой сети с логистической регрессией и увидите, как нейронная сеть имитирует пороговый эффект.\n\n# Сеть с одним скрытым нейроном (имитирует логистическую регрессию)\nnn_1hidden &lt;- neuralnet(p ~ K, data = d, hidden = 1)\n\n# Сравнение с логистической регрессией\nplot(d$K, predict(logit_model, type = \"response\"), \n     type = \"l\", \n     col = \"darkgreen\", \n     lwd = 2,\n     xlab = \"Концентрация\", \n     ylab = \"Смертность\",\n     main = \"Сравнение моделей\")\nlines(d$K, predict(nn_1hidden, d), col = \"blue\", lty = 2, lwd = 2)\nlegend(\"bottomright\", \n       legend = c(\"Логистическая регрессия\", \"Нейронная сеть (1 нейрон)\"),\n       col = c(\"darkgreen\", \"blue\"), \n       lty = 1:2,\n       lwd = 2)\n\n\n\n\nРис. 5.: Сравнение работы",
    "crumbs": [
      "<span class='chapter-number'>3</span>  <span class='chapter-title'>Нейронные сети в экологии: практическое введение</span>"
    ]
  },
  {
    "objectID": "chapter 2.html#классификация-в-экологии",
    "href": "chapter 2.html#классификация-в-экологии",
    "title": "3  Нейронные сети в экологии: практическое введение",
    "section": "3.8 КЛАССИФИКАЦИЯ В ЭКОЛОГИИ",
    "text": "3.8 КЛАССИФИКАЦИЯ В ЭКОЛОГИИ\nВы примените нейронные сети для решения задачи классификации - определения пола гадюк по морфометрическим признакам. Построив и сравнив несколько архитектур сетей (без скрытых нейронов, с одним и тремя нейронами), вы оцените их точность.\n\n# Загрузка данных по гадюкам (пол, длина тела, длина хвоста, масса)\nv &lt;- read.csv(\"vipkar.csv\")\nhead(v, 3)  # Просмотр первых строк данных\n\nМодель без скрытых нейронов (аналог линейной регрессии)\n\nnv0 &lt;- neuralnet(ns ~ lc, data = v, hidden = 0)\nplot(nv0)  # Визуализация простейшей сети\n\n\n\n\nРис. 6.: Визуализация простейшей сети\n\n\nМодель с одним скрытым нейроном\n\nnv1 &lt;- neuralnet(ns ~ lc, data = v, hidden = 1)\nplot(nv1)  # Схема сети с одним нейроном\n\n\n\n\nРис. 7.: Схема сети с одним нейроном\n\n\nМодель с тремя скрытыми нейронами (полноценная нейросеть)\n\nnv3 &lt;- neuralnet(ns ~ lc + lt + w, data = v, hidden = 3)\nplot(nv3)  # Визуализация сложной сети\n\n\n\n\nРис. 8.: Модель с тремя скрытыми нейронами\n\n\nОценка точности классификации\n\npredictions &lt;- predict(nv3, v)\npredicted_sex &lt;- round(predictions)\naccuracy &lt;- mean(v$ns == predicted_sex)\ncat(\"Точность классификации:\", round(accuracy*100, 1), \"%\\n\")\n\nСравнение разных архитектур нейронных сетей (см. срипт KOROSOV_visual.R)\n\n\n\nРис. 9.: Точность определения пола гадюк",
    "crumbs": [
      "<span class='chapter-number'>3</span>  <span class='chapter-title'>Нейронные сети в экологии: практическое введение</span>"
    ]
  },
  {
    "objectID": "chapter 2.html#пространственное-моделирование",
    "href": "chapter 2.html#пространственное-моделирование",
    "title": "3  Нейронные сети в экологии: практическое введение",
    "section": "3.9 ПРОСТРАНСТВЕННОЕ МОДЕЛИРОВАНИЕ",
    "text": "3.9 ПРОСТРАНСТВЕННОЕ МОДЕЛИРОВАНИЕ\nВ завершение вы построите нейронную сеть для прогнозирования численности гадюк на островах по характеристикам биотопов. Вы разделите данные на обучающую и тестовую выборки, оцените точность модели и используете ее для прогноза в новых условиях.\n\n# Данные по островам Кижского архипелага\nv &lt;- read.csv(\"kihzsdat.csv\")\nhead(v, 3)  # Структура данных: площадь, биотопы, численность видов\n\n# Случайное разделение данных на обучающую и тестовую выборки\nset.seed(123)  # Для воспроизводимости\ntrain_indices &lt;- sample(1:nrow(v), 12)\ntrain_data &lt;- v[train_indices, ]\ntest_data &lt;- v[-train_indices, ]\n\n# Построение нейросети с 5 нейронами в скрытом слое\nmodel &lt;- neuralnet(vb ~ fo + me + bo, data = train_data, hidden = 5)\n\n# Прогнозирование на обучающей выборке\ntrain_pred &lt;- predict(model, train_data)\ntrain_accuracy &lt;- mean(round(train_pred) == train_data$vb)\ncat(\"Точность на обучающей выборке:\", round(train_accuracy*100, 1), \"%\\n\")\n\n# Прогнозирование на тестовой выборке\ntest_pred &lt;- predict(model, test_data)\ntest_accuracy &lt;- mean(round(test_pred) == test_data$vb)\ncat(\"Точность на тестовой выборке:\", round(test_accuracy*100, 1), \"%\\n\")\n\n# Прогноз для новых условий (пример)\nnew_conditions &lt;- data.frame(\n  fo = c(57.9, 35.3, 83.0),  # Площадь лесов (%)\n  me = c(4.1, 0.0, 7.3),     # Площадь лугов (%)\n  bo = c(3.4, 7.9, 11.5)     # Площадь болот (%)\n)\n\nfuture_pred &lt;- predict(model, new_conditions)\ncat(\"Прогнозируемая численность гадюк:\", round(future_pred), \"\\n\")",
    "crumbs": [
      "<span class='chapter-number'>3</span>  <span class='chapter-title'>Нейронные сети в экологии: практическое введение</span>"
    ]
  },
  {
    "objectID": "chapter 2.html#численная-оптимизация",
    "href": "chapter 2.html#численная-оптимизация",
    "title": "3  Нейронные сети в экологии: практическое введение",
    "section": "3.3 ЧИСЛЕННАЯ ОПТИМИЗАЦИЯ",
    "text": "3.3 ЧИСЛЕННАЯ ОПТИМИЗАЦИЯ\nЗдесь вы познакомитесь с численными методами оптимизации параметров моделей, которые применяются, когда аналитическое решение невозможно. На примере той же зависимости массы от длины вы подгоните параметры модели с помощью функции nls() и сравните результаты с аналитическим решением.\nАналитические методы дают точное решение в виде математической формулы, используя алгебраические преобразования и теоремы математического анализа. Они идеальны для простых моделей, где существуют явные решения, обеспечивая прозрачную интерпретацию параметров. В экологии такие методы применимы для базовых зависимостей типа линейной регрессии. Численные методы используются, когда аналитическое решение невозможно, и работают через последовательные приближения, начиная со стартовых значений и итеративно улучшая параметры модели. Они незаменимы для сложных экологических моделей с нелинейными зависимостями, взаимодействиями факторов и “шумными” полевыми данными, позволяя решать задачи, недоступные для аналитических подходов.\n\n# Подгонка параметров через оптимизацию\nnls_model &lt;- nls(w ~ a0 + a1 * lt, start = list(a0 = 1, a1 = 1))\nsummary(nls_model)\n\nНа экране появится:\n\nFormula: w ~ a0 + a1 * lt\n\nParameters:\n   Estimate Std. Error t value Pr(&gt;|t|)    \na0 -240.766     64.457  -3.735 0.007308 ** \na1    6.358      1.153   5.516 0.000891 ***\n---\nSignif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1\n\nResidual standard error: 13.81 on 7 degrees of freedom\n\nNumber of iterations to convergence: 1 \nAchieved convergence tolerance: 3.247e-08\n\n\n3.3.1 Интерпретация результатов модели\nМы построили линейную модель зависимости массы гадюки (w) от длины её тела (lt) по формуле:\nw = a0 + a1 * lt\nКлючевые параметры модели:\n\na0 (свободный член): -240.8 г\nЭто теоретическая масса при нулевой длине тела. Отрицательное значение указывает, что модель не подходит для очень молодых особей.\na1 (коэффициент при lt): 6.36 г/см\nКаждый дополнительный сантиметр длины тела увеличивает массу в среднем на 6.36 г.\n\nТочность и значимость:\n\nОба коэффициента высоко значимы (p &lt; 0.01), что подтверждает реальность зависимости.\nСтандартная ошибка для a1 составляет 1.15 г/см - это значит, что реальное значение, вероятно, находится между 5.2 и 7.5 г/см.\nМодель хорошо сошлась за 1 шаг (итерацию), что говорит об удачном подборе параметров.\n\nОшибка прогноза:\nСреднее отклонение предсказаний от реальных значений - 13.8 г (стандартная ошибка остатков). Для особи массой 100 г это означает возможную ошибку прогноза около 14%.\n\nБиологический смысл: Модель подтверждает сильную аллометрию - крупные гадюки имеют относительно большую массу тела. Каждый сантиметр длины добавляет около 6.4 г массы. Для особи длиной 55 см прогнозируемая масса составит: -240.8 + 6.36*55 ≈ 109 г.\n\n##МНОЖЕСТВЕННАЯ РЕГРЕССИЯ\nВ этом разделе мы расширим модель, включив несколько факторов. Вы построите множественную регрессию, учитывающую одновременно длину тела и длину хвоста гадюки, и научитесь интерпретировать влияние нескольких предикторов на зависимую переменную.\n\n# Добавляем новый признак - длину хвоста (lc)\nw &lt;- c(40, 156, 105, 85, 80, 50, 75, 48, 75, 67)\nlt &lt;- c(44, 59, 49, 50, 54, 43, 49, 42, 47, 47)\nlc &lt;- c(70, 78, 66, 90, 83, 70, 62, 75, 40, 80)\n\nИспользуя glm-функцию, построим модель с двумя предикторами: \\[\nw = a_0 + a_1 \\cdot l_t + a_2 \\cdot l_c\n\\]\nгде: - \\(w\\) — масса гадюки, - \\(l_t\\) — длина тела гадюки, - \\(l_c\\) — длина хвоста гадюки, - \\(a_0\\) — свободный член (константа), - \\(a_1\\) — коэффициент регрессии при длине тела, - \\(a_2\\) — коэффициент регрессии при длине хвоста.\n\n# Множественная регрессия: w = a0 + a1*lt + a2*lc\nmulti_reg &lt;- glm(w ~ lt + lc)\nsummary(multi_reg)\n\nНа экране появится:\n\nCall:\nglm(formula = w ~ lt + lc)\n\nCoefficients:\n             Estimate Std. Error t value Pr(&gt;|t|)    \n(Intercept) -191.2982    53.6908  -3.563 0.009183 ** \nlt             6.0308     1.1051   5.457 0.000949 ***\nlc            -0.3150     0.4133  -0.762 0.470913    \n---\nSignif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1\n\n(Dispersion parameter for gaussian family taken to be 270.9752)\n\n    Null deviance: 10132.9  on 9  degrees of freedom\nResidual deviance:  1896.8  on 7  degrees of freedom\nAIC: 88.832\n\nNumber of Fisher Scoring iterations: 2\n\n\n\n3.3.2 Интерпретация результатов множественной регрессии\nМы исследовали зависимость массы гадюки (w) от длины тела (lt) и длины хвоста (lc) с помощью модели:\nw = b0 + b1*lt + b2*lc\nКлючевые выводы модели:\n\nДлина тела (lt) сильно влияет на массу:\n\nКоэффициент: +6.03 г/см\nКаждый сантиметр длины тела увеличивает массу на ~6 г\nВысокая значимость (p = 0.00095)\n\nДлина хвоста (lc) не влияет значимо на массу:\n\nКоэффициент: -0.315 г/см (незначимый)\np-значение 0.47 &gt; 0.05 - статистически недостоверно\nПосле учета длины тела, длина хвоста не добавляет информации\n\nСвободный член (b0): -191.3 г\nОтрицательное значение подтверждает нелинейность роста у молодых особей\n\nКачество модели:\n\nМодель объясняет значительную часть вариации:\nОбщая вариация (Null deviance) = 10132.9\nОстаточная вариация (Residual deviance) = 1896.8 → Объяснено 81% вариации\nAIC = 88.8 (ниже, чем у модели без lc - 92.1, что указывает на лучшее качество)\nМодель быстро сошлась за 2 итерации\n\nБиологическая интерпретация:\n\nМасса тела определяется в основном длиной туловища, а не хвоста\nДля прогноза массы достаточно учитывать только длину тела\nПример прогноза для особи (lt=50 см, lc=70 см):\n-191.3 + 6.03*50 - 0.315*70 ≈ 111 г\n\n\nРекомендация: При изучении массы гадюк можно исключить длину хвоста из модели, так как она не вносит значимого вклада в предсказание. Основным морфометрическим показателем остается длина тела.",
    "crumbs": [
      "<span class='chapter-number'>3</span>  <span class='chapter-title'>Нейронные сети в экологии: практическое введение</span>"
    ]
  }
]